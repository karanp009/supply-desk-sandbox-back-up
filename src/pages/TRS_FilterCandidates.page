<apex:page title="Vacancy Scheduler" standardController="TR1__Job__c" id="pageId" extensions="TRS_FilterCandidates" sidebar="false" tabStyle="Scheduler__tab">
    <apex:messages />
    <apex:includeScript value="{!URLFOR($Resource.jQuery, 'js/jquery-1.9.1.js')}" />
    <apex:includeScript value="{!URLFOR($Resource.jQuery, 'js/jquery-ui-1.10.3.custom.min.js')}" />
    
    <apex:stylesheet value="{!URLFOR($Resource.jQuery, 'css/ui-lightness/jquery-ui-1.10.3.custom.min.css')}" />
    <style>
        .tableStyle {
            margin: 0px;
            padding: 0px;
            width: 100%;
            border: 1px solid #000000;
            border-width: 1px 1px 0px 0px;
            -moz-border-radius-bottomleft: 0px;
            -webkit-border-bottom-left-radius: 0px;
            border-bottom-left-radius: 0px;
            -moz-border-radius-bottomright: 0px;
            -webkit-border-bottom-right-radius: 0px;
            border-bottom-right-radius: 0px;
            -moz-border-radius-topright: 0px;
            -webkit-border-top-right-radius: 0px;
            border-top-right-radius: 0px;
            -moz-border-radius-topleft: 0px;
            -webkit-border-top-left-radius: 0px;
            border-top-left-radius: 0px;
            border-spacing: 0px !important;
        }
        
        .tableStyle table {
            width: 100%;
            height: 100%;
            margin: 0px;
            padding: 0px;
        }
        
        .tableStyle tr:last-child td:last-child {
            -moz-border-radius-bottomright: 0px;
            -webkit-border-bottom-right-radius: 0px;
            border-bottom-right-radius: 0px;
        }
        
        .tableStyle table tr:first-child td:first-child {
            -moz-border-radius-topleft: 0px;
            -webkit-border-top-left-radius: 0px;
            border-top-left-radius: 0px;
        }
        
        .tableStyle table tr:first-child td:last-child {
            -moz-border-radius-topright: 0px;
            -webkit-border-top-right-radius: 0px;
            border-top-right-radius: 0px;
        }
        
        .tableStyle tr:last-child td:first-child {
            -moz-border-radius-bottomleft: 0px;
            -webkit-border-bottom-left-radius: 0px;
            border-bottom-left-radius: 0px;
        }
        
        .tableStyle tr:hover td {
            background-color: #ffffff;
        }
        
        .tableStyle tr:nth-child(odd) {
            background-color: #d4e7f9;
        }
        
        .tableStyle tr:nth-child(even) {
            background-color: #ffffff;
        }
        
        .tableStyle td {
            vertical-align: middle;
            background-color: #e5f2f0;
            border: 1px solid #000000 !important;
            border-width: 0px 0px 1px 1px !important;
            text-align: center;
            padding: 7px;
            font-size: 12px;
            font-family: Arial;
            font-weight: normal;
            color: #000000;
        }
        
        .tableStyle tr:last-child td {
            border-width: 0px 0px 0px 1px;
        }
        
        .tableStyle tr td:last-child {
            border-width: 0px 0px 1px 1px;
        }
        
        .tableStyle tr:last-child td:last-child {
            border-width: 0px 0px 0px 1px;
        }
        
        .tableStyle thead td {
            background: -o-linear-gradient(bottom, #3d8d8d 5%, #285e5e 100%);
            background: -webkit-gradient( linear, left top, left bottom, color-stop(0.05, #3d8d8d), color-stop(1, #285e5e));
            background: -moz-linear-gradient( center top, #3d8d8d 5%, #285e5e 100%);
            filter: progid: DXImageTransform.Microsoft.gradient(startColorstr="#3d8d8d", endColorstr="#285e5e");
            background: -o-linear-gradient(top, #3d8d8d, 285e5e);
            background-color: #3d8d8d;
            border: 0px solid #000000;
            text-align: center;
            border-width: 0px 0px 1px 1px;
            font-size: 12px;
            font-family: Arial;
            font-weight: bold;
            color: #ffffff;
        }
        
        .tableStyle thead:hover td {
            background: -o-linear-gradient(bottom, #3d8d8d 5%, #285e5e 100%);
            background: -webkit-gradient( linear, left top, left bottom, color-stop(0.05, #3d8d8d), color-stop(1, #285e5e));
            background: -moz-linear-gradient( center top, #3d8d8d 5%, #285e5e 100%);
            filter: progid: DXImageTransform.Microsoft.gradient(startColorstr="#3d8d8d", endColorstr="#285e5e");
            background: -o-linear-gradient(top, #3d8d8d, 285e5e);
            background-color: #3d8d8d;
        }
        
        .tableStyle thead {
            border-width: 0px 0px 1px 1px;
        }
        
        .tableStyle thead {
            border-width: 0px 0px 1px 1px;
        }
        
        .labelCol {
            padding-right: 5px;
            font-weight: bold;
            text-align: right;
        }
        
        .redColorStyle {
            background-color: #D95252 !important;
            display: inline-block;
            width: 100%;
            color: white;
            padding: 2px;
            margin-bottom: 2px;
        }
        
        .yellowColorStyle {
            background-color: #F5DA81 !important;
            display: inline-block;
            width: 100%;
            color: white;
            padding: 2px;
            margin-bottom: 2px;
            height: 100%;
        }
        
        .greenColorStyle {
            background-color: #90D93F !important;
            display: inline-block;
            width: 100%;
            color: white;
            padding: 2px;
            margin-bottom: 2px;
        }
        
        .orangeColorStyle {
            background-color: #FE9A2E !important;
            display: inline-block;
            width: 100%;
            color: white;
            padding: 2px;
            margin-bottom: 2px;
            height: 100%;
        }
        
        .grayColorStyle {
            background-color: #B2B2B2 !important;
            display: inline-block;
            width: 100%;
            color: white;
            padding: 2px;
            margin-bottom: 2px;
        }
        
        .blueColorStyle {
            background-color: #00BFFF !important;
            display: inline-block;
            width: 100%;
            color: white;
            padding: 2px;
            margin-bottom: 2px;
            height: 100%;
        }
        
        .peachColorStyle {
            background-color: #F5DA81 !important;
            display: inline-block;
            width: 100%;
            color: white;
            padding: 2px;
            margin-bottom: 2px;
            height: 100%;
        }
        
        .hoverDivClass {
            background-color: rgb(31, 70, 230);
            border-style: dashed;
            border-width: 1px;
            color: white;
        }
        
        .hoverDivClass a {
            color: white;
            text-decoration: none;
        }
        
        .calendarButton {
            /*//background-image: url("{!URLFOR($Resource.Calendar)}");*/
            cursor: pointer;
        }
        
        .ui-tooltip,
        .arrow:after {
            background: white;
            border: 2px solid white;
        }
        
        .ui-tooltip {
            padding: 10px 20px;
            color: white;
            border-radius: 20px;
            font: bold 14px "Helvetica Neue", Sans-Serif;
            box-shadow: 0 0 7px black;
        }
        
        .arrow {
            width: 70px;
            height: 16px;
            overflow: hidden;
            position: absolute;
            left: 50%;
            margin-left: -35px;
            bottom: -16px;
        }
        
        .arrow.top {
            top: -16px;
            bottom: auto;
        }
        
        .arrow.left {
            left: 20%;
        }
        
        .arrow:after {
            content: "";
            position: absolute;
            left: 20px;
            top: -20px;
            width: 25px;
            height: 25px;
            box-shadow: 6px 5px 9px -9px black;
            -webkit-transform: rotate(45deg);
            -moz-transform: rotate(45deg);
            -ms-transform: rotate(45deg);
            -o-transform: rotate(45deg);
            tranform: rotate(45deg);
        }
        
        .arrow.top:after {
            bottom: -20px;
            top: auto;
        }
        
        .ui-widget-overlay {
            z-index: 1;
        }
        
        .ui-dialog-titlebar-close {
            display: none;
        }
        
        input.assignButton {
            background-image: url('{!URLFOR($Resource.Images,'addImage.jpeg')}');
            border-style: none;
        }
        
        .confirmM2 {
            border-color: #39f !important;
        }
        
        .errorM3 {
            border-color: #c00 !important;
        }
        
        .messageText {
            color: black !important;
        }
        
        .leftContainer {
            display: inline-block;
            text-align: left;
            border: 0px;
            float: left;
            width: 65%;
            vertical-align: middle;
        }
        
        .rightContainer {
            display: inline-block;
            text-align: right;
            border: 0px;
            float: right;
            vertical-align: middle;
        }
        
        .tdHeaderStyle {
            font-weight: bold;
            color: #4a4a56;
            font-family: Lucida Grande, Lucida Sans, Arial, sans-serif;
            font-size: 91%;
        }
        
        .btnCSS{
            padding: 0.4em 1em;
            display: block;
            line-height: normal;
            font-weight: bold;
            color: #1c94c4;
            text-align: center;
            font-size: 1.1em;
        }
    </style>
    
    <!-- New Style Tag Added for Send SMS Button -->
    <style type="text/css">
        #iframesrc{
            width: 100%;
            border: 0;
            height: 500px;
            border-radius: 4px;
            /*display:none;*/
        }
        .slds-scope .slds-modal {
            opacity: 0;
            visibility: hidden;
            transition: transform .1s linear,opacity .1s linear;
            position: fixed;
            top: 5%;
            right: 0;
            bottom: 0;
            left: 0;
            z-index: 9001;
        }
        .slds-scope .slds-modal.slds-fade-in-open {
            opacity: 1;
            visibility: visible;
            transition: opacity .1s linear;
            max-width: 640px;
            margin: 0px auto;
            overflow: auto;
        }
        .slds-scope .slds-backdrop {
            transition-duration: .4s;
            width: 100%;
            height: 100%;
            opacity: 0;
            visibility: hidden;
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            background: rgba(8, 7, 7, 0.6);
            z-index: 9000;
        }
        .slds-scope .slds-backdrop_open, .slds-scope .slds-backdrop--open {
            visibility: visible;
            opacity: 1;
            transition: opacity .4s linear;
        }
        .closeIcon{
            opacity: 0;  
            visibility: hidden; 
            float: right;
            font-size: 1rem;
            width: 25px;
            height: 25px;
            cursor: pointer;
            color: #fff;
            background: transparent !important;
            border: none;
            font-size: 2rem;
            position: relative;
            top: -8px;
            transition: transform .1s linear,opacity .1s linear;
        }
        .closeIcon.active{
            visibility: visible;
            opacity: 1;
            transition: opacity .4s linear;
        }
        .slds-modal__content, .slds-modal__container, .slds-modal.slds-fade-in-open{
            outline: 0 !important
        }

        .swal-button{
            background: #7cd1f9 !important;
        }
    </style>
    
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script type="text/javascript">
    
    function checkAll(cb,cbid)
    {
        var inputElem = document.getElementsByTagName("input");                    
        for(var i=0; i<inputElem.length; i++)
        {            
            if(inputElem[i].id.indexOf(cbid)!=-1){                                       
                inputElem[i].checked = cb.checked;
            }
        }
    }
    </script>
    
    <script>
    function bookcall(constring){   
        console.log(constring)                                      
        doBooking(constring);
    }
    </script>
    <script>
    var j$ = jQuery.noConflict();
    j$(function() {
        applyJqueryFunctions();
    });
    
    function applyJqueryFunctions() {
        applyWeekPicker();
        applyTootltip();
        applyButtonToQuickCreate();
    }
    
    function applyButtonToQuickCreate() {
        
        j$("#prevBtnId").button().unbind('click').click(function(event) {
            event.preventDefault();
            previousWeek();
        });
        
        j$("#nextBtnId").button().unbind('click').click(function(event) {
            event.preventDefault();
            console.log('In next week');
            nextWeek();
        });
        
        j$("#prevBtnId2").button().unbind('click').click(function(event) {
            event.preventDefault();
            previousWeek();
        });
        j$("#nextBtnId2").button().unbind('click').click(function(event) {
            event.preventDefault();
            console.log('In next week');
            nextWeek();
        });
        
        j$("#CreateVacancyLink")
        .button()
        .click(function(event) {
            event.preventDefault();
            // createVacancyReord();
            
        });
        
        j$("#CloneVacancyLink")
        .button()
        .click(function(event) {
            event.preventDefault();
            cloneVacancyReord();
            
        });
        
        j$("#SwitchView")
        .button()
        .click(function(event) {
            event.preventDefault();
            window.open('/apex/TRS_FilterJobs', '_self');
            
        });
        
    }
    <!--        <link rel="stylesheet" href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">-->
        
        // WEEK PICKER Code
        function applyWeekPicker() {
            var startDate;
            var endDate;
            
            var selectCurrentWeek = function() {
                window.setTimeout(function () {
                    j$('#weekpicker').datepicker('widget').find('.ui-datepicker-current-day a').addClass('ui-state-active')
                }, 1);
            }
            
            j$('#weekpicker').button().unbind('click').datepicker( {
                
                showOtherMonths     : false,
                selectOtherMonths   : false,
                firstDay            :1,
                onSelect: function(dateText, inst) { 
                    var date        = j$(this).datepicker('getDate');
                    startDate       = new Date(date.getFullYear(), date.getMonth(), date.getDate() - date.getDay()+1);
                    endDate         = new Date(date.getFullYear(), date.getMonth(), date.getDate() - date.getDay() + 7);  
                    console.log(startDate);
                    console.log(endDate);
                    
                    var dateFormat  = inst.settings.dateFormat || j$.datepicker._defaults.dateFormat;
                    
                    selectCurrentWeek();
                    updateWeek(j$.datepicker.formatDate("dd/mm/yy", startDate), j$.datepicker.formatDate("dd/mm/yy", endDate));
                },
                beforeShow: function() {
                    selectCurrentWeek();
                },
                beforeShowDay: function(date) {
                    var cssClass = '';
                    if(date >= startDate && date <= endDate)
                        cssClass = 'ui-datepicker-current-day';
                    return [true, cssClass];
                },
                onChangeMonthYear: function(year, month, inst) {
                    selectCurrentWeek();
                }
            }).datepicker('widget').addClass('ui-weekpicker');
            
            j$('#weekpicker2').button().unbind('click').datepicker( {
                
                showOtherMonths     : false,
                selectOtherMonths   : false,
                firstDay            :1,
                onSelect: function(dateText, inst) { 
                    var date        = j$(this).datepicker('getDate');
                    startDate       = new Date(date.getFullYear(), date.getMonth(), date.getDate() - date.getDay()+1);
                    endDate         = new Date(date.getFullYear(), date.getMonth(), date.getDate() - date.getDay() + 7);  
                    console.log(startDate);
                    console.log(endDate);
                    
                    var dateFormat  = inst.settings.dateFormat || j$.datepicker._defaults.dateFormat;
                    
                    selectCurrentWeek();
                    updateWeek(j$.datepicker.formatDate("dd/mm/yy", startDate), j$.datepicker.formatDate("dd/mm/yy", endDate));
                },
                beforeShow: function() {
                    selectCurrentWeek();
                },
                beforeShowDay: function(date) {
                    var cssClass = '';
                    if(date >= startDate && date <= endDate)
                        cssClass = 'ui-datepicker-current-day';
                    return [true, cssClass];
                },
                onChangeMonthYear: function(year, month, inst) {
                    selectCurrentWeek();
                }
            }).datepicker('widget').addClass('ui-weekpicker');
            
            //j$('.ui-weekpicker .ui-datepicker-calendar tr').on('mousemove', function() { $(this).find('td a').addClass('ui-state-hover'); });
            //j$('.ui-weekpicker .ui-datepicker-calendar tr').live('mouseleave', function() { $(this).find('td a').removeClass('ui-state-hover'); });
        }
    
    function applyTootltip() {
        
        j$( '.applyTooltipStyle' ).tooltip({
            content: function() {
                var element = j$( this );
                if ( element.is( "[title]" ) ) {
                    return element.attr( "title" );
                }
            },
            position: {
                my: "center bottom-20",
                at: "center top",
                using: function( position, feedback ) {
                    j$( this ).css( position );
                    j$( "<div>" )
                    .addClass( "arrow" )
                    .addClass( feedback.vertical )
                    .addClass( feedback.horizontal )
                    .appendTo( this );
                }
            },
            close: function( event, ui ) {
                ui.tooltip.hover(
                    function () {
                        j$(this).stop(true).fadeTo(400, 1); 
                    },
                    function () { 
                        j$(this).fadeOut("400", function(){ j$(this).remove(); })
                    }
                );
            }
        });
    }
    function mergeConfirmation() {
        return confirm('This action cannot be undone. Are you sure you want to cancel the assignment?');
    }
    

    function dbswarning(){
        var myboolean = document.getElementById('pageId:formId:dialogBoxPageBlock:j_id358:j_id395:dbs').value;
        //var myboolean = false;
        console.log('Positive DBS:'+myboolean);
        if(myboolean == 'true'){
           swal("Positive DBS !!");
           console.log('Positive DBS Warning');
        }else{
            console.log('Positive DBS false');
        }
        console.log('Changing value.....');
        document.getElementById('pageId:formId:dialogBoxPageBlock:j_id358:j_id395:dbs').value  = 'false';
        console.log(document.getElementById('pageId:formId:dialogBoxPageBlock:j_id358:j_id395:dbs').value);
    }

    function validateAmount(){
        var initalAamount = document.getElementById("conAmount");
        if(initalAamount != null && initalAamount != 'Undefined'){
            var FinalAamount = document.getElementById("clsHoursRate");
            if(FinalAamount != null && FinalAamount != 'Undefined'){
                if(FinalAamount >initalAamount){
                    alert('you cannot enter gretaer');
                }
            }
            
        }
    }
    //JS method for sidebar 
    
    <!--        <script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script> -->
    
    // WEEK PICKER Code function applyWeekPicker() { var startDate; var endDate; var selectCurrentWeek = function() { window.setTimeout(function () { j$('#weekpicker').datepicker('widget').find('.ui-datepicker-current-day a').addClass('ui-state-active') }, 1); } j$('#weekpicker').button().datepicker( { showOtherMonths : false, selectOtherMonths : false, firstDay :1, onSelect: function(dateText, inst) { var date = j$(this).datepicker('getDate'); startDate = new Date(date.getFullYear(), date.getMonth(), date.getDate() - date.getDay()+1); endDate = new Date(date.getFullYear(), date.getMonth(), date.getDate() - date.getDay() + 7); console.log(startDate); console.log(endDate); var dateFormat = inst.settings.dateFormat || j$.datepicker._defaults.dateFormat; selectCurrentWeek(); updateWeek(j$.datepicker.formatDate("dd/mm/yy", startDate), j$.datepicker.formatDate("dd/mm/yy", endDate)); }, beforeShow: function() { selectCurrentWeek(); }, beforeShowDay: function(date) { var cssClass = ''; if(date >= startDate && date<=e ndDate) cssClass='ui-datepicker-current-day' ; return [true, cssClass]; }, onChangeMonthYear: function(year, month, inst) { selectCurrentWeek(); } }).datepicker( 'widget').addClass( 'ui-weekpicker'); //j$( '.ui-weekpicker .ui-datepicker-calendar tr').on( 'mousemove', function() { $(this).find( 'td a').addClass( 'ui-state-hover'); }); //j$( '.ui-weekpicker .ui-datepicker-calendar tr').live( 'mouseleave', function() { $(this).find( 'td a').removeClass( 'ui-state-hover'); }); } function applyTootltip() { j$( '.applyTooltipStyle' ).tooltip({ content: function() { var element=j $( this ); if ( element.is( "[title]" ) ) { return element.attr( "title" ); } }, position: { my: "center bottom-20", at: "center top", using: function( position, feedback ) { j$( this ).css( position ); j$( "<div>" ) .addClass( "arrow" ) .addClass( feedback.vertical ) .addClass( feedback.horizontal ) .appendTo( this ); } }, close: function( event, ui ) { ui.tooltip.hover( function () { j$(this).stop(true).fadeTo(400, 1); }, function () { j$(this).fadeOut( "400", function(){ j$(this).remove(); }) } ); } }); } function mergeConfirmation() { return confirm( 'This action cannot be undone. Are you sure you want to cancel the assignment?'); } </script>
    <div class="slds-scope">
        <apex:form id="formId">
            <!-- Send SMS Modal -->
            <!-- Modal -->
            <div role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal">
                <div class="slds-modal__container">
                    
                    
                    <!-- <header class="slds-modal__header">
<button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close">
<svg class="slds-button__icon slds-button__icon_large" aria-hidden="true">
<use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#close" />
</svg>
<span class="slds-assistive-text">Close</span>
</button>
<h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Modal Header</h2>
</header> -->
                    <div class="slds-modal__content" id="modal-content-id-1">
                        <!--  <div style="text-align: right;">
<span class="closeIcon" onclick="CloseModal()"> &times; </span>
</div>-->
                        <iframe src="" id="iframesrc" ></iframe>
                    </div>
                    <!-- <footer class="slds-modal__footer">
<button class="slds-button slds-button_neutral">Cancel</button>
<button class="slds-button slds-button_brand">Save</button>
</footer> -->
                </div>
            </div>
            <div class="slds-backdrop"></div>
            <!-- Send SMS Modal End -->
            
            <apex:pageMessages id="pgMessage" />
            <c:DependentMultiPicklistComponent_v1 />
            <apex:actionStatus onStart="blockMe();" onstop="unBlockMe();changeCursorToPointor();" id="waitMsg" />
            <!-- Actionfnction for sidebar -->
            <apex:actionFunction action="{!matchCSDJSDslots}" name="doBooking" rerender="SchedulerDiv,pgMessage,dialogBox" status="searchOverlay" oncomplete="applyJqueryFunctions();">
                <apex:param name="contact1" assignTo="{!contact1}" value=""/>
            </apex:actionFunction>
            <apex:actionFunction name="previousWeek" oncomplete="applyJqueryFunctions();" action="{!previousWeek}" rerender="tableRec,pgMessage,calanderWeek" status="searchOverlay" />
            <apex:actionFunction name="nextWeek" oncomplete="applyJqueryFunctions();" action="{!nextWeek}" rerender="tableRec,pgMessage,calanderWeek" status="searchOverlay" />
            
            <!-- OVERLAY COMPONENT - START -->
            <TR1:Overlay style="processing" id="search" />
            <apex:actionStatus id="searchOverlay" onStart="showOverlay();" onstop="hideOverlay();" />
            <div id="overlay"></div>
            <!-- OVERLAY COMPONENT - END -->
            <!--    <apex:outputPanel rendered="{!returnPage}">-->
            <!--                <h2 id = "msgId">-->
            <!--                    {!strReturnMsg}-->
            <!--                </h2>-->
            <!--</apex:outputPanel>-->
            <apex:pageBlock id="pgBlckId">
                <apex:pageBlockSection columns="1" title="Select Vacancy">
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value=" Select Vacancy" />
                        <apex:outputPanel >
                            <apex:inputField value="{!grossProfit.TR1__Job__c}" />
                            <apex:commandButton value="Go" action="{!getVacancyDetails}" />
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                </apex:pageBlockSection>
                
                <apex:pageBlockSection columns="2" title="Vacancy Details" rendered="{!vacancy.id != null}">
                    <apex:pageBlockSectionItem dataStyle="text-align:left; width: 30%; max-width: 30%;">
                        <apex:outputLabel value="Vacancy Name" />
                        <apex:outputPanel >
                            <apex:outputlink value="/{!vacancy.id}" target="_blank">{!vacancy.Name}</apex:outputlink>
                            <apex:outputLink value="/apex/TRS_JobCalendar?vacancyId={!vacancy.id}" style="cursor:pointer;" target="_blank">
                                <apex:image value="{!URLFOR($Resource.Images, 'calendar.png')}" width="30" height="30"/>
                            </apex:outputLink>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem dataStyle="text-align:left; width: 30%; max-width: 30%;padding-right: 24%;">
                        <apex:outputLabel value="Client Name" />
                        <apex:outputField value="{!vacancy.TR1__Account__c}" />
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem dataStyle="text-align:left; width: 30%; max-width: 30%;padding-right: 20%;">
                        <apex:outputLabel value="Job Title" />
                        <apex:outputField value="{!vacancy.Job_Title__c}" />
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem dataStyle="text-align:left; width: 30%; max-width: 30%;">
                        <apex:outputLabel value="Contact" />
                        <apex:outputField value="{!vacancy.TR1__Contact__c}" />
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem dataStyle="text-align:left; width: 30%; max-width: 30%;">
                        <apex:outputLabel value="Subject" />
                        <apex:outputField value="{!vacancy.Subject2__c}" />
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem dataStyle="text-align:left; width: 30%; max-width: 30%;">
                        <apex:outputLabel />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem dataStyle="text-align:left; width: 30%; max-width: 30%;padding-right: 20%;">
                        <apex:outputLabel value="Year/Key Stage" />
                        <apex:outputField value="{!vacancy.Year_Key_Stage__c}" />
                    </apex:pageBlockSectionItem>
                    
                    <!--    <apex:pageBlockSectionItem dataStyle="text-align:left; width: 30%; max-width: 30%;">-->
                    <!--            <apex:outputLabel value="Area" />-->
                    <!--            <apex:outputField value="{!vacRecord.TR1__State_Area__c}" />-->
                    <!--    </apex:pageBlockSectionItem>-->
                    <!--      <apex:pageBlockSectionItem dataStyle="text-align:left; width: 30%; max-width: 30%;">-->
                    <!--            <apex:outputLabel value="Sector" />-->
                    <!--            <apex:outputField value="{!vacRecord.Sector1__c}" />-->
                    <!--    </apex:pageBlockSectionItem>-->
                    
                    <!--    <apex:pageBlockSectionItem dataStyle="text-align:left; width: 30%; max-width: 30%;">-->
                    <!--            <apex:outputLabel value="Regional Area" />-->
                    <!--            <apex:outputField value="{!vacRecord.TR1__Regional_Area__c}" />-->
                    <!--    </apex:pageBlockSectionItem>-->
                    
                    <!--<apex:pageBlockSectionItem >-->
                    <!--    <apex:outputlabel value="Specialism, Quals, Experience & Training" />-->
                    <!--    <apex:outputField value="{!vacRecord.Specialism__c}" />  -->
                    <!--</apex:pageBlockSectionItem>-->
                    
                    <!--   <apex:pageBlockSectionItem dataStyle="text-align:left; width: 30%; max-width: 30%;">-->
                    <!--            <apex:outputlabel value="Region" />-->
                    <!--            <apex:outputField value="{!vacRecord.LEA__c}" /> -->
                    <!--    </apex:pageBlockSectionItem>-->
                    
                    <!--<apex:pageBlockSectionItem dataStyle="text-align:left; width: 30%; max-width: 30%;padding-right: 24%;">-->
                    <!--    <apex:outputLabel value="Branch" />-->
                    <!--    <apex:outputField value="{!vacancy.Branch__c}" />-->
                    <!--</apex:pageBlockSectionItem>--> 
                    
                    <!--<apex:pageBlockSectionItem dataStyle="text-align:left; width: 30%; max-width: 30%;padding-right: 20%;">-->
                    <!--        <apex:outputLabel value="SEN Experience" />-->
                    <!--        <apex:outputField value="{!vacRecord.SEN_Experience__c}" />-->
                    <!--</apex:pageBlockSectionItem>-->
                    
                    <!--<apex:pageBlockSectionItem dataStyle="text-align:left; width: 30%; max-width: 30%;padding-right: 20%;">-->
                    <!--        <apex:outputLabel value="SEN Additional Experience" />-->
                    <!--        <apex:outputField value="{!vacRecord.SEN_Additional_Experience__c}" />-->
                    <!--</apex:pageBlockSectionItem>-->
                    
                    <!--<apex:pageBlockSectionItem dataStyle="text-align:left; width: 30%; max-width: 30%;">-->
                    <!--        <apex:outputLabel value="Qualifications" />-->
                    <!--        <apex:outputField value="{!vacRecord.Qualifications__c}" />-->
                    <!--</apex:pageBlockSectionItem>-->
                    
                    <!--<apex:pageblockSectionitem dataStyle="text-align:left; width: 30%; max-width: 30%;">-->
                    <!--    <apex:outputLabel value="LEA" />-->
                    <!--    <apex:outputField value="{!vacRecord.Sub_LEA__c}" />-->
                    <!--</apex:pageblockSectionitem>-->
                    
                    <!--<apex:pageBlockSectionItem dataStyle="text-align:left; width: 30%; max-width: 30%;">-->
                    <!--    <apex:outputLabel value="Skills Training Experience" />-->
                    <!--    <apex:outputField value="{!vacancy.Skills_Training_Experience__c}" />-->
                    <!--</apex:pageBlockSectionItem>-->
                </apex:pageBlockSection>
            </apex:pageBlock>
            
            <apex:actionRegion >
                <apex:outputPanel id="calanderWeek">
                    <div id="headerId" style="text-align:center; width:100%;">
                        <table width="100%">
                            <tr>
                                <td width="35%" style="text-align:left;vertical-align:bottom;">
                                    <apex:outputPanel id="navigationPanel">
                                        <span id="toolbar">
                                            <a href="#" id="CreateVacancyLink" onclick="createVacancyReord();">Create Vacancy</a>
                                        </span>
                                        <span id="toolbar" style="{!IF(vacancy.id != null, '', 'display:none')}">
                                            <a href="#" id="CloneVacancyLink" >Clone Vacancy</a>
                                        </span>
                                        <span id="toolbar"> 
                                            <a href="#" id="SwitchView">Switch</a>
                                        </span>
                                    </apex:outputPanel>
                                </td>
                                <td width="30%" style="text-align:center;vertical-align:bottom;{!IF(OR(isPermanant,noRecordSelected),'display:none','')}">
                                    <h1 class="h2Style" style="font-size: 18px;">
                                        Calendar for Week {!week} <br/>
                                    </h1>
                                </td>
                                <td width="35%"></td>
                                <!--<td width="35%" style="text-align:right;{!IF(OR(isPermanant,noRecordSelected),'display:none','')}">-->
                                <!--    <button id="prevBtnId">Previous</button>-->
                                <!--    <input type="button" id="weekpicker" class="calendarButton" value="Select Week" />-->
                                <!--    <button id="nextBtnId">Next</button>-->
                                <!--</td>-->
                            </tr>
                        </table>
                        
                        <br/><br/>
                        <apex:actionFunction name="updateWeek" action="{!updateWeek}" rerender="formId" status="searchOverlay" oncomplete="applyJqueryFunctions();">
                            <apex:param name="startDateStr" value="str" assignTo="{!startDateStr}" />
                            <apex:param name="endDateStr" value="str" assignTo="{!endDateStr}" />
                        </apex:actionFunction>
                        
                        <!--<apex:actionFunction name="previousWeek" oncomplete="applyJqueryFunctions();" action="{!previousWeek}" rerender="tableRec,pgMessage,calanderWeek" status="searchOverlay" />-->
                        <!--<apex:actionFunction name="nextWeek" oncomplete="applyJqueryFunctions();" action="{!nextWeek}" rerender="tableRec,pgMessage,calanderWeek" status="searchOverlay" />-->
                    </div>
                </apex:outputPanel>
                
                <apex:pageBlock rendered="{!isPermanant == false}" id="FilterpgBlckId">
                    <!-- FILTER SECTION - START -->
                    <apex:pageBlockSection title="Candidate Filters" columns="2" collapsible="true" id="filterSection">
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Name" />
                            <apex:inputField value="{!VacancyRecord.TR1__Contact__c}" />
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem >
                            <apex:outputlabel value="Area" />
                            <apex:inputField value="{!con.TR1__State_Area__c}" />
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageblockSectionItem >
                            <apex:outputLabel value="Compliance Status" />
                            <apex:selectList value="{!complianceStatusValue}" multiselect="false" size="1">
                                <apex:selectOptions value="{!complianceStatus}" />
                            </apex:selectList>
                        </apex:pageblockSectionItem>
                        
                        <apex:pageblockSectionItem >
                            <apex:outputLabel value="Regional Area" />
                            <apex:inputField value="{!con.TR1__Regional_Area__c}" />
                        </apex:pageblockSectionItem>
                        
                        <apex:pageBlockSectionItem id="pubsi0">
                            <!-- <apex:outputLabel value="Sector" />
<apex:inputField value="{!vacRecord.Sector1__c}" />-->
                            <!--<apex:outputPanel id="pbOp">-->
                            <!--    <apex:selectList size="1" id="sectorSelect" value="{!selectedSector}" onchange="loadSubSectors();" style="width:200px;">-->
                            <!--        <apex:selectOptions value="{!sectors}"></apex:selectOptions>-->
                            <!--        <apex:actionFunction name="UpdateDependentSubSectorList" action="{!refreshForSector}" reRender="pbOp1,pbOp2,pbOp3,pbOp4,scriptId" status="searchOverlay">-->
                            <!--            <apex:param name="options" value="" assignTo="{!allSubSectors}" />-->
                            <!--        </apex:actionFunction>-->
                            <!--    </apex:selectList>-->
                            <!--    <script>-->
<!--        /**-->
                            <!--        window.onload = function() {-->
                            <!--            loadSubSectors();-->
                            <!--        };-->
                            <!--        **/-->
                                <!--    </script>-->
                            <!--</apex:outputPanel>-->
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Region" />
                            <apex:inputfield value="{!con.LEA__c}"/>
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="People Owner" />
                            <apex:inputfield value="{!con.Hidden_Scheduler_Filter__c}" /> 
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="LEA" />
                            <!--<apex:outputLabel value="Region" />-->
                            <apex:inputfield value="{!con.Preferred_LEA__c}" /><!--Updated on 5-DEC-16--> 
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Branch" />
                            <apex:inputfield value="{!con.Division__c}" />
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Client Worked for"/>
                            <apex:inputfield value="{!con.AccountId}" />
                            <!--<apex:selectList value="{!SingleAccountId}" multiselect="true" size="5">-->
                            <!--    <apex:selectOptions value="{!AccountSet}"/>-->
                            <!--</apex:selectList>-->
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Post Code" />
                            <apex:inputField value="{!con.OtherPostalCode}" /> 
                        </apex:pageBlockSectionItem>
                        
                        <!-- <apex:pageBlockSectionItem >-->
                        <!--    <apex:outputLabel value="Candidate Status " />-->
                        <!--    <apex:selectList value="{!candidateStatus}" size="1" multiSelect="false"> -->
                        <!--        <apex:selectOptions value="{!candidatestautsList}" />-->
                        <!--    </apex:selectList>-->
                        <!--</apex:pageBlockSectionItem>-->
                        
                        
                        <!--<apex:pageblockSectionItem >-->
                        <!--</apex:pageblockSectionItem>-->
                        
                        <!--<apex:pageBlockSectionItem id="pubsi1">-->
                        <!--    <apex:outputLabel value="Sub Sector" />-->
                        <!--    <apex:outputPanel id="pbOp1">-->
                        <!--        <apex:selectList size="5" multiselect="true" id="subSectorSelect" value="{!selectedSubSector}" onchange="loadJobTitlesAndSpecialisms();" style="width:200px;">-->
                        <!--            <apex:selectOptions value="{!subsectors}"></apex:selectOptions>-->
                        <!--            <apex:actionFunction name="UpdateDependentList" reRender="pbOp2,pbOp3" status="searchOverlay" action="{!refreshForSubSector}">-->
                        <!--                <apex:param name="options1" value="" assignTo="{!alljobtitles}" />-->
                        <!--<apex:param name="options2" value="" assignTo="{!allSpecialisms}" />-->
                        <!--            </apex:actionFunction>-->
                        <!--        </apex:selectList>-->
                        <!--    </apex:outputPanel>-->
                        <!--</apex:pageBlockSectionItem>-->
                        
                        <!-- <apex:pageBlockSectionItem >-->
                        <!--    <apex:outputLabel value="LEA" />-->
                        <!--    <apex:inputfield value="{!con.Sub_LEA__c}" />-->
                        <!--</apex:pageBlockSectionItem>-->
                        
                        <!--<apex:pageblockSectionItem >-->
                        <!--</apex:pageblockSectionItem>-->
                        
                        <!--<apex:pageblockSectionItem >-->
                        <!--</apex:pageblockSectionItem>-->
                        
                        <!--<apex:pageblockSectionItem >-->
                        <!--</apex:pageblockSectionItem>-->
                        
                        <!--<apex:pageBlockSectionItem >-->
                        <!--<apex:outputlabel value="Client Worked For" />-->
                        <!--<apex:inputField value="{!con.Sub_LEA__c}" />-->
                        <!--</apex:pageBlockSectionItem>-->
                        
                        
                        
                    </apex:pageBlockSection>
                    
                    <apex:pageBlockSection title="Candidate SET Filters" columns="2" id="Filter" >
                        
                        <!--  <apex:pageBlockSectionItem >
<apex:outputLabel value="Trained As" />
<apex:inputfield value="{!con.Trained_As__c}" />
</apex:pageBlockSectionItem> -->
                        
                        <apex:pageBlockSectionItem id="pbsi31122">
                            <apex:outputLabel value="Job Title" />
                            <apex:outputPanel id="pbOp2">
                                <!--<apex:selectList size="5" multiselect="true" id="jobTitleSelect" value="{!selectedJobTitle}" style="width:200px;">-->
                                <!--    <apex:selectOptions value="{!jobtitles}"></apex:selectOptions>-->
                                <!--</apex:selectList>-->
                                <apex:inputField value="{!con.Job_Titles__c}" />
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                        <!--<apex:pageBlockSectionItem >-->
                        <!--    <apex:outputLabel value="Qualifications" />-->
                        <!--    <apex:inputfield value="{!con.Qualificaitons__c}" />-->
                        <!--</apex:pageBlockSectionItem>-->
                        
                        <apex:pageblockSectionItem >
                            <apex:outputLabel value="Subject" />
                            <apex:inputField value="{!con.Subject__c}" />
                            <!--<apex:outputLabel value="Sub Sector" />-->
                            <!--<apex:inputField value="{!vacRecord.Sub_Sector__c}" />-->
                            <!--<apex:selectList value="{!selectedSubSector}" multiselect="false" size="1">-->
                            <!--    <apex:selectOptions value="{!subsectors}" />-->
                            <!--</apex:selectList>-->
                        </apex:pageblockSectionItem>

                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="SEN" />
                            <apex:inputfield value="{!con.SEN__c}" />
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Year/Key Stage  " />
                            <apex:inputfield value="{!con.Year_Key_Stage__c}" />
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem id="pbsi3">
                            <apex:outputLabel value="SEN Experience" />
                            <apex:inputfield value="{!con.SEN_Experience__c}" />
                        </apex:pageBlockSectionItem>
                        
                        
                        <!--  <apex:pageBlockSectionItem >
<apex:outputLabel value="SEN Skills, Quals and Training" />
<apex:inputfield value="{!con.SEN_Additional_Experience__c}" />
</apex:pageBlockSectionItem>-->
                        
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Skills Training Experience" />
                            <apex:inputfield value="{!con.Skills_Training_Experience__c}" />
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem >
                            <apex:inputCheckbox value="{!isSortingByDistances}" />
                            <apex:outputLabel value="Sort By Distance" style="font-weight: bold;"/>
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem >
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem >
                            <apex:inputCheckbox value="{!isPersonPlaced}" />
                            <apex:outputLabel value="Previously Placed Candidate" style="font-weight: bold;"/>
                        </apex:pageBlockSectionItem>
                        
                    </apex:pageBlockSection>
                    <!--<apex:outputPanel id="filter3"> -->
                    <!--    <apex:pageBlock >-->
                    <!--        <apex:pageBlockSection title="Refined Results" collapsible="true" >-->
                    
                    <!--        </apex:pageBlockSection>-->
                    <!--    </apex:pageBlock>-->
                    <!--</apex:outputPanel>-->
                    <table width="100%">
                        <tr>
                            <td width="35%"></td>
                            <td width="28%">
                                <center>
                                    <apex:commandButton action="{!getResourceAvailability}" value="Filter Candidates" rerender="tableRec,pgMessage,filter3" oncomplete="applyJqueryFunctions();" status="searchOverlay" style="text-align:centre;" />
                                    <apex:commandButton action="{!resetFilters}" value="Reset Filters" rerender="filterSection,tableRec,pgMessage,filter3,Filter" oncomplete="applyJqueryFunctions();" status="searchOverlay" style="text-align:centre;" />
                                    <!--<apex:commandButton action="{!MassSMSmethod}" value="Mass SMS" rerender="filterSection,tableRec,pgMessage,filter3,Filter" oncomplete="applyJqueryFunctions();" status="searchOverlay" style="text-align:centre;" /> -->
                                    <apex:commandButton value="Send SMS" rerender="none" onclick="sendSMSList();"/>
                                    
                                </center>
                            </td>
                            
                            <td width="35%">
                                <button id="nextBtnId" style="float: right;">Next Week</button>
                                <input type="button" id="weekpicker" class="calendarButton" value="Select Week" style="float: right;"/>
                                <button id="prevBtnId" style="float: right;">Previous Week</button>
                            </td>
                        </tr>
                        
                        
                        
                        <!--<center>-->
                        <!--    <apex:commandButton action="{!getResourceAvailability}" value="Filter Candidates" rerender="tableRec,pgMessage,filter3" oncomplete="applyJqueryFunctions();" status="searchOverlay" style="text-align:centre;" />-->
                        <!--    <apex:commandButton action="{!resetFilters}" value="Reset Filters" rerender="filterSection,tableRec,pgMessage,filter3,Filter" oncomplete="applyJqueryFunctions();" status="searchOverlay" style="text-align:centre;" />-->
                        <!--<apex:commandButton value="Daxtra Search" rerender="formId" oncomplete="applyJqueryFunctions();" status="searchOverlay" style="text-align:centre;" />-->
                        <!--</center>-->
                        <!--<right>-->
                        <!--    <button id="prevBtnId">Previous</button>-->
                        <!--    <input type="button" id="weekpicker" class="calendarButton" value="Select Week" />-->
                        <!--    <button id="nextBtnId">Next</button>-->
                        <!--</right>-->
                    </table>
                    <!-- FILTER SECTION - END -->
                    
                    <br/>
                    <br/>
                    
                    <script>
                    function sendSMSList(){
                        var records = [];
                        var strIDs='';
                        j$('input:checked').each(function() {
                            if(j$(this).attr('CandidateId') != undefined)
                                records.push(j$(this).attr('CandidateId'));
                        });
                        
                        console.log('---records--'+records);
                        
                        if(records[0] == null) 
                        { 
                            alert("Please select at least one Record.");
                            //var iframe_url = '{!URLFOR("apex/tdc_tsw__SendBulkSMS?ids=")}'+ strIDs + '&retURL='+window.location.href;
                            j$('#iframesrc').attr('src', '');
                            
                        }else{
                            console.log('>>>>>>>>>strIDS'+strIDs);
                            
                            for (var n=0; n<records.length; n++){
                                if(strIDs == ''){
                                    strIDs = records[n];
                                }else{
                                    strIDs = strIDs + "," + records[n];
                                }
                            }
                            j$('.slds-modal').addClass('slds-fade-in-open');
                            
                            j$('.slds-backdrop').addClass('slds-backdrop_open');
                            j$('.closeIcon').addClass('active');
                            
                            var iframe_url = '{!URLFOR("apex/tdc_tsw__SendBulkSMS?ids=")}'+ strIDs + '&retURL='+window.location.href;
                            j$('#iframesrc').attr('src', iframe_url);
                        }        
                    }                                   
                    </script>
                    <apex:outputPanel id="tableRec">
                        <apex:outputPanel rendered="{!OR(Resources.size>0,grossProfit.TR1__Job__c==null)}" id="WrapperPanel">
                            <div>
                                <table class="tableStyle" id="tableClass1">
                                    <tr>
                                        <td style="width: 6px;"></td>
                                        <td width="225.5px">
                                            <b>Job Schedules</b>
                                        </td>
                                        <td width="4.6%">
                                        </td>
                                        <td width="4.6%">
                                        </td>
                                        <td width="4.6%">
                                        </td>
                                        <apex:repeat value="{!Resources[0].weekDayMap}" var="Date" rendered="{!isweekDayMapPopulated}">
                                            <td width="50px" >  
                                                <apex:repeat value="{!weekDayMap[Date]}" var="vaccAss">
                                                    <table width="100%">
                                                        <tr>
                                                            <td style="border:none !important; padding:0px">
                                                                <div style="width:100%; display:{!IF(vaccAss.Start_Date_Time__c!=null , '','None')}">
                                                                    <div class="leftContainer,greenColorStyle">
                                                                        <apex:outputText value="{0, date,hh:mm a }">
                                                                            <apex:param value="{!vaccAss.Start_Date_Time__c+offset}" />
                                                                        </apex:outputText>
                                                                        -
                                                                        <apex:outputText value="{0, date,  hh:mm a }">
                                                                            <apex:param value="{!vaccAss.End_Date_Time__c+offset}" />
                                                                        </apex:outputText>
                                                                    </div> 
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </apex:repeat>
                                            </td>
                                        </apex:repeat>
                                        <td width="50px" style="{!IF(!isweekDayMapPopulated,'','display:none')}">&nbsp;</td>
                                        <td width="50px" style="{!IF(!isweekDayMapPopulated,'','display:none')}">&nbsp;</td>
                                        <td width="50px" style="{!IF(!isweekDayMapPopulated,'','display:none')}">&nbsp;</td>
                                        <td width="50px" style="{!IF(!isweekDayMapPopulated,'','display:none')}">&nbsp;</td>
                                        <td width="50px" style="{!IF(!isweekDayMapPopulated,'','display:none')}">&nbsp;</td>
                                        <td width="50px" style="{!IF(!isweekDayMapPopulated,'','display:none')}">&nbsp;</td>
                                        <td width="50px" style="{!IF(!isweekDayMapPopulated,'','display:none')}">&nbsp;</td>
                                        <td class="EmptyTD" width="3.2%">
                                        </td>
                                    </tr>
                                </table>
                                <table class="tableStyle" id="tableClass">
                                    
                                    <!--Job Section ends here-->
                                    <thead>
                                        <td style="width: 1%;"><apex:inputCheckbox onclick="checkAll(this,'checkedone')"/></td>
                                        <td width="220px">
                                            <div reRender="vacaniesPanel" oncomplete="applyJqueryFunctions();">
                                                <apex:commandLink action="{!getResourceAvailability}" value="Candidate Name" id="cmdSort">
                                                    <apex:param value="name" name="column" assignTo="{!sortExpression}"></apex:param>
                                                </apex:commandLink>
                                            </div>
                                        </td>
                                        <td width="3%">
                                            Withheld 
                                        </td>
                                        <td width="3%">
                                            Distance
                                        </td>
                                        <td width="3%">
                                            Calendar
                                        </td>
                                        <!--<td width = "120px">-->
                                        <!--    <div reRender = "vacaniesPanel">-->
                                        <!--        <apex:commandLink action="{!getResourceAvailability}" value="LEA{!IF(sortExpression=='Current_LEA__c',IF(sortDirection='ASC','?','?'),'')}" id="cmdSort1" > -->
                                        <!--        <apex:param value="Current_LEA__c" name="column" assignTo="{!sortExpression}" ></apex:param>-->
                                        <!--        </apex:commandLink> -->
                                        <!--    </div>-->
                                        <!--</td>-->
                                        <!--<td width = "120px">-->
                                        <!--    <div reRender = "vacaniesPanel"> -->
                                        <!--        <apex:commandLink action="{!getResourceAvailability}" value="SUB-LEA{!IF(sortExpression=='Sub_LEA__c',IF(sortDirection='ASC','?','?'),'')}" id="cmdSort2" > -->
                                        <!--        <apex:param value="Sub_LEA__c" name="column" assignTo="{!sortExpression}" ></apex:param>     -->
                                        <!--        </apex:commandLink>  -->
                                        <!--    </div>-->
                                        <!--</td>-->
                                        <!--<td>Compliance Status</td>-->
                                        <!--<td>Calendar</td>-->
                                        <apex:repeat value="{!weekHeader}" var="week">
                                            <td>
                                                <apex:outputText escape="false" value="{!week}" />
                                            </td>
                                        </apex:repeat>
                                        <td width="3%">
                                            Book
                                        </td>
                                    </thead>
                                    
                                    <!--Candidate Section ends here -->
                                    <apex:repeat value="{!resources}" var="resource">
                                        <tr  >
                                            <!--<apex:outputLink >-->
                                            <!--<apex:outputtext value='Click here to scheduler ' ></apex:outputtext>-->
                                            <!--</apex:outputLink>-->
                                            <td><apex:inputCheckbox html-CandidateId="{!resource.Candidate.Id}" id="checkedone" value="{!resource.isSelected}"/></td>
                                            <td>
                                                <div id="{!resource.Candidate.Id}" class="droppableDiv" style="width:100%;" data-candidate-id="{!resource.Candidate.Id}" data-name="{!resource.Candidate.Name}">
                                                    <apex:outputLink value="/{!resource.Candidate.Id}" target="_blank" title="{!resource.tooltipContent}" styleClass="applyTooltipStyle">
                                                        {!resource.Candidate.Name}
                                                    </apex:outputLink> 
                                                    <apex:outputPanel rendered="{!vacancy.id != null && isPersonPlaced}">
                                                        <h3 style="color:red;font-size: 1.2rem !important;">{!mapToShowPersonPlaced[resource.Candidate.id]}</h3> 
                                                    </apex:outputPanel>
                                                    <br/>
                                                    <!--LEA: {!resource.Candidate.LEA__c}<br/>-->
                                                    <!--SUB LEA: {!resource.Candidate.Sub_LEA__c}<br/>-->
                                                    <!--Compliace Status : {!resource.Candidate.Compliance_Status__c}<br/>-->
                                                    Contact Banner : <apex:outputText value="{!resource.Candidate.Contact_Type__c}" style="cursor:pointer;" escape="false"/><br/>
                                                    
                                                    <apex:outputpanel rendered="{!IF(resource.Candidate.MobilePhone  !=Null,true,false)}">Mobile : <apex:outputText value="{!resource.Candidate.MobilePhone}" style="cursor:pointer;"  escape="false"/><br/></apex:outputpanel>
                                                </div>
                                            </td>
                                            <td> 
                                                <apex:outputPanel rendered="{!vacancy.id != null}">
                                                    {!mapToShowWithHeld[resource.Candidate.Id]}
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!vacancy.id == null}">
                                                    -
                                                </apex:outputPanel>
                                            </td>
                                            <td>
                                                <apex:outputPanel rendered="{!vacancy.id != null}">
                                                    {!resource.distanceVal} mi
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!vacancy.id == null}">
                                                    N/A
                                                </apex:outputPanel>
                                            </td>
                                            <td>
                                                <apex:outputLink value="/apex/TRS_CandidateCalendar?contactId={!resource.Candidate.Id}" style="cursor:pointer;" target="_blank">
                                                    <apex:image value="{!URLFOR($Resource.Images, 'calendar.png')}" width="30" height="30" />
                                                </apex:outputLink>
                                            </td>
                                            
                                            <!--<td>{!resource.Candidate.LEA__c}</td>-->
                                            <!--<td>{!resource.Candidate.Sub_LEA__c}</td>-->
                                            <!--<td width="100px">{!resource.Candidate.Compliance_Status__c}</td>-->
                                            
                                            <apex:repeat value="{!resource.dateAvailMap}" var="dates">
                                                
                                                <td width="50px">
                                                    <table>
                                                        
                                                        <apex:repeat value="{!resource.dateAvailMap[dates]}" var="ddWrap">
                                                            <tr width="100px">
                                                                <td style="border-width: 0px 0px 0px 0px !important; padding: 0px;display:{!IF(ddWrap.canAvailabilityRec.Start_Date_Time__c!=null , '','None')}">
                                                                    <apex:outputPanel rendered="{!ddWrap.canAvailabilityRec!=null}">
                                                                        <div class="{!ddWrap.dayDetail1.colorStyle}">
                                                                            <apex:outputPanel styleClass="applyTooltipStyle" rendered="{!ddWrap.dayDetail1.Status == 'Booked'}" title="{!ddWrap.dayDetail1.tooltipContent}">
                                                                                <div style="width:100%">
                                                                                    <div class="leftContainer,{!ddWrap.dayDetail1.colorStyle}" >
                                                                                        {!ddWrap.dayDetail1.assignedJobName}
                                                                                        
                                                                                        <apex:outputText value="{0, date,hh:mm a }">
                                                                                            <apex:param value="{!ddWrap.canAvailabilityRec.Start_Date_Time__c+offset}" />
                                                                                        </apex:outputText>
                                                                                        -
                                                                                        <apex:outputText value="{0, date,  hh:mm a }">
                                                                                            <apex:param value="{!ddWrap.canAvailabilityRec.End_Date_Time__c+offset}" />
                                                                                        </apex:outputText>
                                                                                        
                                                                                        
                                                                                    </div>
                                                                                    <div>
                                                                                        {!ddWrap.dayDetail1.closingReportSchedule.Closing_Report__r.TR1__Account__r.School_Alias__c} 
                                                                                    </div>
                                                                                    
                                                                                </div>
                                                                            </apex:outputPanel>
                                                                            <apex:outputPanel rendered="{!ddWrap.dayDetail1.Status != 'Booked'}">
                                                                                <div style="width:100%">
                                                                                    <div class="leftContainer,{!ddWrap.dayDetail1.colorStyle}" >
                                                                                        <apex:outputPanel id="pnlpreview">
                                                                                            <apex:outputPanel rendered="{!ddWrap.dayDetail1.Status == 'Available'}">
                                                                                                <apex:outputText value="{0, date,hh:mm a }">
                                                                                                    <apex:param value="{!ddWrap.canAvailabilityRec.Start_Date_Time__c+offset}" />
                                                                                                </apex:outputText>
                                                                                                -
                                                                                                <apex:outputText value="{0, date,  hh:mm a }">
                                                                                                    <apex:param value="{!ddWrap.canAvailabilityRec.End_Date_Time__c+offset}" />
                                                                                                </apex:outputText>
                                                                                                
                                                                                                <div>
                                                                                                    <!-- this add button would be inside green box -->
                                                                                                    <!--<apex:image value="{!URLFOR($Resource.Images,'add-button-md.png')}" height="20" width="20" style="cursor:pointer;" rendered="{!AND(Count!=0,resource.jobAvailCount!=0)}">  -->
                                                                                                    
                                                                                                    <a href="javascript:void(0);" onclick="domatchCSDJSDslots('{!resource.Candidate.Id}','{!resource.Candidate.Name}','{!resource.enddate}','{!dates}');return false;" style="cursor:pointer; text-decoration:None ; display:{!IF(AND(Count!=0,resource.jobAvailCount!=0),'','none')}"><span style="color:White">Book Slot</span> 
                                                                                                        
                                                                                                    </a>
                                                                                                    
                                                                                                    <!--End this add button would be inside green box -->
                                                                                                </div>
                                                                                                
                                                                                            </apex:outputPanel>
                                                                                            
                                                                                        </apex:outputPanel>
                                                                                        <apex:outputPanel rendered="{!OR(ddWrap.dayDetail1.Status == 'Unknown',ddWrap.dayDetail1.Status == 'UnknownScheduler')}">
                                                                                            <apex:outputText value="{0, date,hh:mm a }">
                                                                                                <apex:param value="{!ddWrap.canAvailabilityRec.Start_Date_Time__c+offset}" />
                                                                                            </apex:outputText>
                                                                                            -
                                                                                            <apex:outputText value="{0, date,  hh:mm a }">
                                                                                                <apex:param value="{!ddWrap.canAvailabilityRec.End_Date_Time__c+offset}" />
                                                                                            </apex:outputText>
                                                                                        </apex:outputPanel>
                                                                                        
                                                                                        
                                                                                        
                                                                                    </div>
                                                                                </div> 
                                                                            </apex:outputPanel>
                                                                        </div>
                                                                    </apex:outputPanel>
                                                                </td>
                                                            </tr>
                                                            
                                                        </apex:repeat>
                                                    </table>
                                                </td>
                                            </apex:repeat>
                                            <td>
                                                <!--{!resource.jobAvailCount} resource.jobAvailCount-- AND Count---{!Count}-->
                                                <apex:image value="{!URLFOR($Resource.Images,'add-button-md.png')}" height="20" width="20" style="cursor:pointer;" rendered="{!AND(Count!=0,resource.jobAvailCount!=0)}">  
                                                    <apex:actionSupport event="onclick" action="{!matchCSDJSDslots}" rerender="SchedulerDiv,pgMessage,dialogBox" status="searchOverlay" oncomplete="applyJqueryFunctions();">
                                                        <apex:param name="contact1" assignTo="{!contact1}" value="{!resource.Candidate.Id}"/>
                                                        <!--<apex:param name="CandidateId" value="{!resource.Candidate.Id}" />-->
                                                        <apex:param name="CandidateName" value="{!resource.Candidate.Name}" />
                                                        <apex:param name="vacancyDate"  value="{!resource.enddate}" />
                                                        
                                                        <!--<apex:param name="shift" value="{!ddWrap.dayDetail1.CandidAvailshift}" />-->
                                                        <!--<apex:param name="VaccAvailShift" value="{!ddWrap.dayDetail1.VacAvailshift}" />-->
                                                    </apex:actionSupport>
                                                </apex:image>
                                                {!resource.Candidate.Name}
                                            </td>
                                        </tr>
                                    </apex:repeat>
                                </table>
                            </div>
                            
                            <apex:actionFunction action="{!matchCSDJSDslots}" name="domatchCSDJSDslots" status="searchOverlay" oncomplete="applyJqueryFunctions();" rerender="SchedulerDiv,pgMessage,dialogBox,pnlpreview" >
                                <apex:param name="contact1" assignTo="{!contact1}" value=""/>
                                <apex:param name="CandidateName" value="" />
                                <apex:param name="vacancyDate"  value="" />
                                <apex:param name="vacancyStartDates" value="" assignTo="{!vacancyStartDate}"/>
                            </apex:actionFunction>
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!Resources.size=0}">
                            No matching Contacts found for selected filters. Please refine your search filters.
                            
                        </apex:outputPanel>
                    </apex:outputPanel>
                    <!-- adf  -->
                    <apex:outputPanel id="pagiDiv"> 
                        <table width="100%" >
                            <tr>
                                <td width="35%"></td>
                                <td width="28%">
                                    <center>
                                        <apex:commandButton action="{!getResourceAvailability}" value="Filter Candidates" rerender="tableRec,pgMessage,filter3" oncomplete="applyJqueryFunctions();" status="searchOverlay" style="text-align:centre;" />
                                        <apex:commandButton action="{!resetFilters}" value="Reset Filters" rerender="filterSection,tableRec,pgMessage,filter3,Filter" oncomplete="applyJqueryFunctions();" status="searchOverlay" style="text-align:centre;" />
                                        <!--   <apex:commandButton action="{!MassSMSmethod}" value="Mass SMS" rerender="filterSection,tableRec,pgMessage,filter3,Filter" oncomplete="applyJqueryFunctions();" status="searchOverlay" style="text-align:centre;" /> -->
                                        <apex:commandButton value="Send SMS" rerender="none" onclick="sendSMSList();"/>
                                        
                                    </center>
                                </td>
                                <!-- Pagination -->
                                <td width="14%">
                                    <apex:outputPanel id="pDiv">
                                        
                                        <apex:commandButton action="{!previouspaginaton}" value="Previous Page" disabled="{!IF(OFFSETvalue == 0,true,false)}" rerender="tableRec,pDiv" status="MyStatus1" oncomplete="applyJqueryFunctions();"/>
                                        <apex:selectList id="ListSize" size="1" value="{!SelectSize}" onchange="changeListsizeJS();" label="PageSize">
                                            <apex:selectOption itemValue="5" itemLabel="5"/>
                                            <apex:selectOption itemValue="10" itemLabel="10"/>
                                            <apex:selectOption itemValue="20" itemLabel="20"/>
                                            <apex:selectOption itemValue="25" itemLabel="25"/>
                                            <apex:selectOption itemValue="50" itemLabel="50"/>
                                            <apex:selectOption itemValue="100" itemLabel="100"/>
                                            <apex:actionFunction name="changeListsizeJS" action="{!changeListsize}" rerender="tableRec,pDiv" oncomplete="applyJqueryFunctions();"/>
                                        </apex:selectList> 
                                        <apex:commandButton action="{!nextpaginaton}" value="Next Page" rerender="tableRec,pDiv" oncomplete="applyJqueryFunctions();" disabled="{!IF(recordSize < SelectSize,true,false)}" status="MyStatus1" />
                                        &nbsp;<apex:actionStatus stopText="" id="MyStatus1">
                                        <apex:facet name="start">
                                            <img src="/img/loading.gif" />
                                        </apex:facet>
                                        </apex:actionStatus>&nbsp;
                                    </apex:outputPanel>
                                </td>
                                <!--End Pagination -->
                                
                                <td width="25%">
                                    <button id="nextBtnId2"  style="float: right;" >Next Week</button>
                                    <input type="button" id="weekpicker2"  value="Select Week"  style="float: right;"/>
                                    <button id="prevBtnId2"  style="float: right;" >Previous Week</button>
                                </td> 
                            </tr>
                        </table>
                    </apex:outputPanel>
                    
                </apex:pageBlock>
            </apex:actionRegion>
            
            <apex:outputPanel id="SchedulerDiv">
                <apex:outputPanel rendered="{!showSection}">
                    <style>
                        .messageText {
                        color: black;
                        }
                    </style>
                    <script>
                    j$('#schedulebar').dialog({
                        title: 'Booking Confirmation',
                        resizable: false,
                        modal: true,
                        closeOnEscape: false,
                        width: 900,
                        position: {
                            my: "center",
                            at: "center"
                        },
                        zIndex: 990,
                        buttons: {
                            "Save": function() {
                                //event.preventDefault();
                                if (true) {
                                    j$(this).dialog("destroy");
                                }
                            },
                            Close: function() {
                                j$(this).dialog("destroy");
                            }
                        },
                    }).parent().appendTo(j$("#pageId\\:formId"));
                    
                    // Destroy all Tooltips
                    j$('.applyTooltipStyle').tooltip("destroy");
                    </script>
                    
                    <div class="schedulebar" style="display:block">
                        <style>
                            .messageText {
                            color: black;
                            }
                            
                            .datePicker {
                            z-index: 1000;
                            }
                        </style>
                        <script>
                        j$('#showMatching').dialog({
                            title: 'Matching',
                            resizable: false,
                            modal: true,
                            closeOnEscape: false,
                            width: 900,
                            position: {
                                my: "center",
                                at: "center"
                            },
                            zIndex: 990,
                            buttons: {
                                /*"Save": function() {
                                    //event.preventDefault();
                                    if (true) {
                                        saveClosingReport();
                                        j$(this).dialog("destroy");
                                    }
                                },*/
                                Close: function() {
                                    //refresh();
                                    j$(this).dialog("destroy");
                                }
                            },
                        }).parent().appendTo(j$("#pageId\\:formId"));
                        
                        // Destroy all Tooltips
                        j$('.applyTooltipStyle').tooltip("destroy");
                        </script>
                        <div id="showMatching" style="display:none">
                            <table>
                                <tr>
                                    <td></td>
                                    <apex:repeat value="{!csdJSDateMap}" var="dates">
                                        <td>
                                            <apex:outputText value="{0, date,dd/MM/yy}">
                                                <apex:param value="{!dates}" />
                                            </apex:outputText>
                                        </td>
                                    </apex:repeat>
                                </tr>
                                
                                <tr>
                                    <td>Candidate Availability</td>
                                    <apex:repeat value="{!csdJSDateMap}" var="dates">
                                        <td>
                                            <apex:repeat value="{!csdJSDateMap[dates]}" var="v">
                                                <apex:outputPanel rendered="{!v.canAvail.Id!=null}">
                                                    <table title="Candidate Availability">
                                                        <tr>
                                                            <td>
                                                                <div class="{!v.Colour}">
                                                                    <apex:outputText value="{0, date,hh:mm a }">
                                                                        <apex:param value="{!v.canAvail.Start_Date_Time__c+offset}" />
                                                                    </apex:outputText>
                                                                    -
                                                                    <apex:outputText value="{0, date,  hh:mm a }">
                                                                        <apex:param value="{!v.canAvail.End_Date_Time__c+offset}" />
                                                                    </apex:outputText>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </apex:outputPanel>
                                            </apex:repeat>
                                        </td>
                                    </apex:repeat>
                                </tr>
                                
                                <tr>
                                    <td>Vacancy Schedule</td>
                                    <apex:repeat value="{!csdJSDateMap}" var="dates">
                                        <td>
                                            <apex:repeat value="{!csdJSDateMap[dates]}" var="v">
                                                <apex:outputPanel rendered="{!v.vaccAvail.Start_Date_Time__c!=null}">
                                                    <table title="Vacancy Schedule">
                                                        <tr>
                                                            <td>
                                                                <div class="{!v.Colour}" >
                                                                    <apex:outputText value="{0, date,hh:mm a }">
                                                                        <apex:param value="{!v.vaccAvail.Start_Date_Time__c+offset}" />
                                                                    </apex:outputText>
                                                                    -
                                                                    <apex:outputText value="{0, date,  hh:mm a }">
                                                                        <apex:param value="{!v.vaccAvail.End_Date_Time__c+offset}" />
                                                                    </apex:outputText>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </apex:outputPanel>
                                            </apex:repeat>
                                        </td>
                                    </apex:repeat>
                                </tr>
                            </table>
                        </div>
                    </div>
                </apex:outputPanel>
            </apex:outputPanel>
            
            <apex:outputPanel id="dialogBox">
                <apex:outputPanel rendered="{!showAssignmentDialogBox}">
                    <style>
                        .messageText {
                        color: black;
                        }
                        
                        .datePicker {
                        z-index: 1000;
                        }
                    </style>
                    <script>
                    j$('#createClosingReportDiv').dialog({
                        title: 'Book Candidate',
                        resizable: false,
                        modal: true,
                        closeOnEscape: false,
                        width: 900,
                        position: {
                            my: "center",
                            at: "center"
                        },
                        zIndex: 990,
                        buttons: {
                            "Save": function() {
                                //event.preventDefault();
                                if (true) {
                                    saveClosingReport();
                                    j$(this).dialog("destroy");
                                }
                            },"Partial Save": function() {
                                //event.preventDefault();
                                if (true) {
                                    PatialsaveClosingReport();
                                    j$(this).dialog("destroy");
                                }
                            },
                            Close: function() {
                                //refresh();
                                j$(this).dialog("destroy");
                            }
                        },
                    }).parent().appendTo(j$("#pageId\\:formId"));
                    
                    // Destroy all Tooltips
                    j$('.applyTooltipStyle').tooltip("destroy");
                    
                    applyButtonSet();
                    
                    function applyButtonSet() {
                        j$("#selectDaysDiv").buttonset();
                    }
                    
                    
                    j$('input[name*=targetDateToUpdate]').datepicker({
                        changeMonth: true,
                        changeYear: true,
                        dateFormat: "dd/mm/yy",
                        firstDay: 1
                    });

                    var value1;
                
                var sum;
                function val1() {

                    
                    value1 = document.getElementById("daypayrate").value;
                    console.log(value1);
                
        			var value2 = document.getElementById("daychargerate").value;
                    console.log(value2);

                    //gppd=value2 - (value1 + (value1 * 0.13)) || AS BURDEN RATE INCREASED, CHANGED VALUE FROM 0.095 TO 0.13 || 11/04/2022
                    if(!value1=="" && !value2=="")
                    {
                        sum1 = value1 * 0.13;
                        console.log('sum1:'+sum1);
                        console.log('val1:'+value1);

                        sum = parseFloat(value1)+parseFloat(sum1);
                        console.log('sum:'+sum);

                        total = value2 - sum;
                        gppd = Math.round(total * 100) / 100;
                        console.log('gppd:'+gppd);
                        document.getElementById("total").innerHTML=gppd;

                        if(gppd <= 48.00){
                            document.getElementById("total").style.backgroundColor  = "#FF0000";
                            swal("Margin is below target !!");
                        }else if(gppd >48.01 && gppd<51.01){
                            document.getElementById("total").style.backgroundColor  = "#FFBF00";
                        }else{
                            document.getElementById("total").style.backgroundColor  = "#ADFF2F";
                        }
                    }else if(!value1=="" && value2==""){
                        document.getElementById("total").innerHTML = "--";
                    }else if(!value2=="" && value1==""){
                        document.getElementById("total").innerHTML = "--";
                    }else{
                        document.getElementById("total").innerHTML = "--";
                    }
                }
                    </script>
                    
                    <style>
                        .spinner {
                            position: fixed;
                            top: 50%;
                            left: 50%;
                            margin-top: -50px; 
                            margin-left: -50px; 
                        }
                    </style>
                    <apex:outputPanel id="SpinnerId">
                     <apex:actionStatus id="loadingscreen">
                        <apex:facet name="start">
                            <apex:outputPanel styleclass="spinner">
                                <img src="/img/loading32.gif" width="40" height="40" />
                                <br/>
                                <apex:outputLabel value="Loading..."/>
                            </apex:outputPanel>            
                        </apex:facet>
                     </apex:actionStatus> 
                    </apex:outputPanel>

                    <apex:actionFunction name="saveClosingReport" action="{!saveClosingReport}" rerender="SchedulerDiv,pgMessage,dialogBox,createClosingReportDiv" oncomplete="applyJqueryFunctions();applyButtonSet();dbswarning();" status="loadingscreen">
                        <apex:param name="partialsave" value="False"  />
                    </apex:actionFunction>
                    <apex:actionFunction name="PatialsaveClosingReport" action="{!saveClosingReport}" rerender="SchedulerDiv,pgMessage,dialogBox,createClosingReportDiv" oncomplete="applyJqueryFunctions();applyButtonSet();" status="searchOverlay" >
                        <apex:param name="partialsave" value="True"  />
                    </apex:actionFunction>
                    
                    <apex:actionFunction oncomplete="applyJqueryFunctions();" status="searchOverlay" immediate="true" name="refresh" action="{!refresh}" rerender="formId" />
                    
                    
                    
                    
                    
                    <div id="createClosingReportDiv" style="display:none">
                        
                        <!-- Show matching-->
                        <table > <!-- border="1" style="border-collapse: collapse;"-->
                            
                            <tr>
                                <td></td>
                                <apex:repeat value="{!csdJSDateMap}" var="dates">
                                    <td>
                                        <apex:outputText value="{0, date,dd/MM/yy}">
                                            <apex:param value="{!dates}" />
                                        </apex:outputText>
                                    </td>
                                </apex:repeat>
                            </tr>
                            <tr>
                                <td>Candidate Availability</td>
                                <apex:repeat value="{!csdJSDateMap}" var="dates">
                                    <td>
                                        <apex:repeat value="{!csdJSDateMap[dates]}" var="v">
                                            <table title="Candidate Availability">
                                                <tr>
                                                    <!--  <td style="display:{!IF(v.canAvail.Id!=null , '', 'None')}">-->
                                                    <td >
                                                        <div class="{!v.Colour}">
                                                            <apex:outputText value="{0, date,hh:mm a }">
                                                                <apex:param value="{!v.canAvail.Start_Date_Time__c+offset}" />
                                                            </apex:outputText>
                                                            -
                                                            <apex:outputText value="{0, date,  hh:mm a }">
                                                                <apex:param value="{!v.canAvail.End_Date_Time__c+offset}" />
                                                            </apex:outputText>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </table>
                                        </apex:repeat>
                                    </td>
                                </apex:repeat>
                            </tr>
                            <tr>
                                <td>Vacancy Schedule</td>
                                <apex:repeat value="{!csdJSDateMap}" var="dates">
                                    <td>
                                        <apex:repeat value="{!csdJSDateMap[dates]}" var="v">
                                            <apex:outputPanel id="Withshiftsec" rendered="{!csdJSDateMap[dates]!=null}">
                                                <table title="Vacancy Schedule">
                                                    <tr>
                                                        <!-- <td style="display:{!IF(v.vaccAvail.Id!=null , '', 'None')}"> -->
                                                        <td >
                                                            <div class="{!v.Colour}">
                                                                <apex:outputText value="{0, date,hh:mm a }">
                                                                    <apex:param value="{!v.vaccAvail.Start_Date_Time__c+offset}" />
                                                                </apex:outputText>
                                                                -
                                                                <apex:outputText value="{0, date,  hh:mm a }">
                                                                    <apex:param value="{!v.vaccAvail.End_Date_Time__c+offset}" />
                                                                </apex:outputText>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!csdJSDateMap==null}" id="Nullsection">
                                                There are no Availability on job created yet for current week.
                                            </apex:outputPanel>
                                        </apex:repeat>
                                    </td>
                                </apex:repeat>
                            </tr>
                            <tr>
                                <td style="font-size:large;font-weight: 700;">GPPD (Gross Profit Per Day) : </td>
                                    <td>
                                        <table title="gppd">
                                            <tr>
                                                <td>
                                                    <div >
                                                        <label id="total" style="font-size:x-large;font-weight: bold;">--</label>
                                                    </div>
                                                </td>
                                            </tr>
                                        </table>   
                                    </td>
                            </tr>
                        </table>
                        
                        <!--  CREATE CLOSING REPORT -->
                        <apex:pageBlock id="dialogBoxPageBlock">
                            <apex:pageMessages id="closingReportMsgId" />
                            
                            <apex:pageBlockSection >
                                <apex:pageBlockSectionItem >
                                    <apex:outputLabel value="Vacancy" />
                                    <!--                                <apex:outputLink value="/{!vacancy.Id}" target="_blank">                             -->
                                    {!vacancy.Name}
                                    <!--                                </apex:outputLink> -->
                                </apex:pageBlockSectionItem>
                                <apex:pageBlockSectionItem >
                                    <apex:outputLabel value="Candidate" />
                                    <!--                                <apex:outputLink value="/{!candidateId}" target="_blank">                            -->
                                    {!candidateName}
                                    <!--                                </apex:outputLink> -->
                                </apex:pageBlockSectionItem>
                                
                                <apex:outputField value="{!vacancy.Maximum_Hour_Pay_Rate__c}" label="Maximum Hour Pay Rate" rendered="{!closingReport.id != null}"/>
                                <apex:outputField value="{!vacancy.Maximum_Hour_Charge_Rate__c}" label="Maximum Hour Charge Rate" rendered="{!closingReport.id != null}"/>
                                <apex:outputField value="{!vacancy.TR1__Maximum_Pay_Rate__c}" label="Maximum Day Pay Rate" rendered="{!closingReport.id != null}"/>
                                <apex:outputField value="{!vacancy.TR1__Maximum_Bill_Rate__c}" label="Maximum Day Charge Rate" rendered="{!closingReport.id != null}"/>
                                <apex:outputField value="{!vacancy.TR1__Minimum_Pay_Rate__c}" label="Maximum Half Day Pay Rate" rendered="{!closingReport.id != null}"/>
                                <apex:outputField value="{!closingReport.Maximum_Half_Day_Charge_Rate__c}" label="Maximum Half Day Charge Rate" rendered="{!closingReport.id != null}"/>
                                
                                <!--   <apex:pageBlockSectionItem >
<apex:outputPanel id="thePageBlock2_label" >
<apex:outputLabel value="Hour Pay Rate" for="maxHRPay" rendered="{!closingReport.Pay_Type__c=='Hourly'}"/>
<apex:outputLabel value="Day Pay Rate" for="maxDPay" rendered="{!closingReport.Pay_Type__c=='Daily'}"/>
<apex:outputLabel value="Half Day Rate Agreed" for="maxHLFPay" rendered="{!OR(closingReport.Pay_Type__c=='AM',closingReport.Pay_Type__c=='PM')}"/>
</apex:outputPanel>

<apex:outputPanel id="thePageBlock2" >
<apex:inputField value="{!closingReport.Maximum_Hour_Pay_Rate__c}"  rendered="{!closingReport.Pay_Type__c=='Hourly'}" id="maxHRPay"  />
<apex:inputField value="{!closingReport.Maximum_Day_Pay_Rate__c}"  rendered="{!closingReport.Pay_Type__c=='Daily'}" id="maxDPay" />
<apex:inputField value="{!closingReport.Maximum_Half_Day_Pay_Rate__c}"  rendered="{!OR(closingReport.Pay_Type__c=='AM',closingReport.Pay_Type__c=='PM')}" id="maxHLFPay"  />
</apex:outputPanel>
</apex:pageBlockSectionItem> -->
                                
                                <!--<apex:inputField value="{!closingReport.TR1__Job_Credit__c}" rendered="{!closingReport.id == null}" />-->
                                
                                <apex:outputField value="{!closingReport.Maximum_Hour_Pay_Rate__c}" label=" Hour Pay Rate" rendered="{!closingReport.id != null}"/>
                                <apex:outputField value="{!closingReport.Maximum_Hour_Charge_Rate__c}" label=" Hour Charge Rate" rendered="{!closingReport.id != null}"/>
                                <apex:outputField value="{!closingReport.Maximum_Day_Pay_Rate__c}" label=" Day Pay Rate" rendered="{!closingReport.id != null}"/>
                                <apex:outputField value="{!closingReport.Maximum_Day_Charge_Rate__c}" label=" Day Charge Rate" rendered="{!closingReport.id != null}"/>
                                <apex:outputField value="{!closingReport.Maximum_Half_Day_Pay_Rate__c}" label=" Half Day Pay Rate" rendered="{!closingReport.id != null}"/>
                                <apex:outputField value="{!closingReport.Maximum_Half_Day_Charge_Rate__c}" label=" Half Day Charge Rate" rendered="{!closingReport.id != null}"/>
                                
                                <apex:outputField value="{!conToShowRate.Hourly_Rate_Agreed__c}" label="Maximum Hour Pay Rate" rendered="{!closingReport.id == null}" id="conAmount"/>
                                <apex:outputField value="{!vacancy.Maximum_Hour_Charge_Rate__c}" label="Maximum Hour Charge Rate" rendered="{!closingReport.id == null}"/>
                                <apex:inputField value="{!closingReport.Maximum_Hour_Pay_Rate__c}" label=" Hour Pay Rate" rendered="{!closingReport.id == null}" id="clsHoursRate"/>
                                <apex:inputField value="{!closingReport.Maximum_Hour_Charge_Rate__c}" label=" Hour Charge Rate" rendered="{!closingReport.id == null}"/>
                                
                                <apex:outputField value="{!conToShowRate.Daily_Rate_Agreed__c}" label="Maximum Day Pay Rate" rendered="{!closingReport.id == null}"/>
                                <apex:outputField value="{!vacancy.TR1__Maximum_Bill_Rate__c}" label="Maximum Day Charge Rate" rendered="{!closingReport.id == null}"/>
                                <apex:inputField value="{!closingReport.Maximum_Day_Pay_Rate__c}" label=" Day Pay Rate" rendered="{!closingReport.id == null}"/>
                                <apex:inputField value="{!closingReport.Maximum_Day_Charge_Rate__c}" label=" Day Charge Rate" rendered="{!closingReport.id == null}"/>
                                
                                <apex:outputField value="{!conToShowRate.Half_Day_Rate_Agreed__c}" label="Maximum Half Day Pay Rate" rendered="{!closingReport.id == null}"/>
                                <apex:outputField value="{!vacancy.TR1__Minimum_Bill_Rate__c}" label="Maximum Half Day Charge Rate" rendered="{!closingReport.id == null}"/>
                                <apex:inputField value="{!closingReport.Maximum_Half_Day_Pay_Rate__c}" label=" Half Day Pay Rate" rendered="{!closingReport.id == null}"/>
                                <apex:inputField value="{!closingReport.Maximum_Half_Day_Charge_Rate__c}" label="Maximum Half Day Charge Rate" rendered="{!closingReport.id == null}"/>
                                
                                <!-- <apex:outputField value="{!closingReport.Maximum_Pay_rate_Per_Day__c}" label="Pay Rate Calculator" rendered="{!closingReport.id == null}"/>
                                <apex:outputField value="{!closingReport.Maximum_Charge_Per_Day__c}" label="Charge Rate Calculator" rendered="{!closingReport.id == null}"/>
                                <apex:inputField value="{!closingReport.Maximum_Pay_rate_Per_Day__c}" id="daypayrate" rendered="{!closingReport.id == null}" onkeyup="val1()"/>
                                <apex:inputField value="{!closingReport.Maximum_Charge_Per_Day__c}" id="daychargerate" rendered="{!closingReport.id == null}" onkeyup="val1()"/>
                                <apex:inputHidden id="dbs" value="{!positivedbs}" /> -->

                                <apex:pageBlockSectionItem >
                                <apex:outputLabel value="Pay Rate Calculator"/>
                                <apex:outputPanel >
                                    <apex:outputField value="{!closingReport.Maximum_Pay_rate_Per_Day__c}" rendered="{!closingReport.id != null}"/>
                                    <input value="{!closingReport.Maximum_Pay_rate_Per_Day__c}" id="daypayrate" rendered="{!closingReport.id == null}" onfocusout="val1()"/>
                                </apex:outputPanel>
                            </apex:pageBlockSectionItem>
                            
                            <apex:pageBlockSectionItem > 
                                <apex:outputLabel value="Charge Rate Calculator"/>
                                <apex:outputPanel >
                                    <apex:outputField value="{!closingReport.Maximum_Charge_Per_Day__c}" rendered="{!closingReport.id != null}"/>
                                    <input value="{!closingReport.Maximum_Charge_Per_Day__c}" id="daychargerate" rendered="{!closingReport.id == null}" onfocusout="val1()"/>
                                </apex:outputPanel>
                            </apex:pageBlockSectionItem>
                                
                            <apex:pageBlockSectionItem >
                                <apex:inputHidden id="dbs" value="{!positivedbs}" />
                            </apex:pageBlockSectionItem>
                                <!--<apex:outputField value="{!vacancy.Maximum_Hour_Pay_Rate__c}" label="Maximum Hour Pay Rate" />-->
                                <!--<apex:outputField value="{!closingReport.Maximum_Hour_Pay_Rate__c}" label=" Hour Pay Rate" rendered="{!closingReport.id != null}"/>-->
                                <!--<apex:inputField value="{!closingReport.Maximum_Hour_Pay_Rate__c}" label=" Hour Pay Rate" rendered="{!closingReport.id == null}"/>-->
                                
                                <!--<apex:outputField value="{!vacancy.Maximum_Hour_Charge_Rate__c}" label="Maximum Hour Charge Rate" />-->
                                <!--<apex:outputField value="{!closingReport.Maximum_Hour_Charge_Rate__c}" label=" Hour Charge Rate" rendered="{!closingReport.id != null}"/>-->
                                <!--<apex:inputField value="{!closingReport.Maximum_Hour_Charge_Rate__c}" label=" Hour Charge Rate" rendered="{!closingReport.id == null}"/>-->
                                
                                <!--<apex:outputField value="{!vacancy.TR1__Maximum_Pay_Rate__c}" label="Maximum Day Pay Rate" />-->
                                <!--<apex:outputField value="{!closingReport.Maximum_Day_Pay_Rate__c}" label=" Day Pay Rate" rendered="{!closingReport.id != null}"/>-->
                                <!--<apex:inputField value="{!closingReport.Maximum_Day_Pay_Rate__c}" label=" Day Pay Rate" rendered="{!closingReport.id == null}"/>-->
                                
                                <!--<apex:outputField value="{!vacancy.TR1__Maximum_Bill_Rate__c}" label="Maximum Day Charge Rate" />-->
                                <!--<apex:outputField value="{!closingReport.Maximum_Day_Charge_Rate__c}" label=" Day Charge Rate" rendered="{!closingReport.id != null}"/>-->
                                <!--<apex:inputField value="{!closingReport.Maximum_Day_Charge_Rate__c}" label=" Day Charge Rate" rendered="{!closingReport.id == null}"/>-->
                                
                                <!--<apex:outputField value="{!closingReport.Maximum_Half_Day_Pay_Rate__c}" label=" Half Day Pay Rate" rendered="{!closingReport.id != null}"/>-->
                                <!--<apex:inputField value="{!closingReport.Maximum_Half_Day_Pay_Rate__c}" label=" Half Day Pay Rate" rendered="{!closingReport.id == null}"/>-->
                                
                                <!--<apex:outputField value="{!closingReport.Maximum_Half_Day_Charge_Rate__c}" label=" Half Day Charge Rate" rendered="{!closingReport.id != null}"/>-->
                                <!--<apex:inputField value="{!closingReport.Maximum_Half_Day_Charge_Rate__c}" label="Maximum Half Day Charge Rate" rendered="{!closingReport.id == null}"/>-->
                                
                                
                                
                                
                                <!--<apex:outputField value="{!closingReport.TR1__Start_Date__c}" />-->
                                <!--<apex:outputField value="{!closingReport.TR1__End_Date__c}" />-->
                                
                                <!--<apex:pageBlockSectionItem rendered="{!closingReport.id == null}">-->
                                <!--    <apex:outputLabel value="Charge Rate" />-->
                                <!--    <apex:inputField value="{!closingReport.TR1__Bill_Rate__c}" required="true" />-->
                                <!--</apex:pageBlockSectionItem>-->
                                <!--<apex:pageBlockSectionItem rendered="{!closingReport.id != null}">-->
                                <!--    <apex:outputLabel value="Charge Rate" />-->
                                <!--    <apex:outputField value="{!closingReport.TR1__Bill_Rate__c}" />-->
                                <!--</apex:pageBlockSectionItem>-->
                                <!--<apex:inputField value="{!closingReport.TR1__Pay_Rate__c}" required="true" rendered="{!closingReport.id == null}" />-->
                                <!--<apex:outputField value="{!closingReport.TR1__Pay_Rate__c}" rendered="{!closingReport.id != null}" />
<apex:inputField value="{!vacancy.TR1__Hiring_Manager__c}" required="true" rendered="{!closingReport.id == null}" Label=" Hiring Manager"/>-->
                                <apex:outputField value="{!vacancy.TR1__Hiring_Manager__r.Name}" Label=" Hiring Manager"/>                             
                                
                                <apex:inputField value="{!closingReport.Pay_Type__c}" required="true" rendered="{!closingReport.id == null}" Label="Pay Type">
                                    <!--<apex:actionSupport event="onchange" rerender="dialogBoxPageBlock,closingReportMsgId,thePageBlock,thePageBlock_label,thePageBlock2,thePageBlock2_label,thePageBlock3,thePageBlock4,vacMsgId" status="searchOverlay" action="{!dummyFunction}" />-->
                                </apex:inputField>
                                <apex:outputField value="{!closingReport.Pay_Type__c}" rendered="{!closingReport.id != null}" />
                                
                                <apex:pageBlockSectionItem >
                                    <apex:outputLabel value="Contact"/>   
                                    <apex:outputLabel value="{!clientContact}"/>                                            
                                </apex:pageBlockSectionItem>
                                
                                <!-- <apex:pageBlockSectionItem >
<apex:outputPanel id="thePageBlock2_label" >
<apex:outputLabel value="Hour Charge Rate" for="maxHRPay" rendered="{!closingReport.Pay_Type__c=='Hourly'}"/>
<apex:outputLabel value="Day Charge Rate" for="maxDPay" rendered="{!closingReport.Pay_Type__c=='Daily'}"/>
<apex:outputLabel value="Half Day Charge Rate" for="maxHLFPay" rendered="{!OR(closingReport.Pay_Type__c=='AM',closingReport.Pay_Type__c=='PM')}"/>
</apex:outputPanel>

<apex:outputPanel id="thePageBlock2" >
<apex:inputField value="{!closingReport.Maximum_Hour_Charge_Rate__c}"  rendered="{!closingReport.Pay_Type__c=='Hourly'}" id="maxHRPay" />
<apex:inputField value="{!closingReport.Maximum_Day_Charge_Rate__c}"  rendered="{!closingReport.Pay_Type__c=='Daily'}" id="maxDPay" />
<apex:inputField value="{!closingReport.Maximum_Half_Day_Charge_Rate__c}"  rendered="{!OR(closingReport.Pay_Type__c=='AM',closingReport.Pay_Type__c=='PM')}" id="maxHLFPay"  />
</apex:outputPanel>
</apex:pageBlockSectionItem>-->
                                
                                <apex:inputField value="{!VacancyRecord.Booking_Type__c}" required="true" rendered="{!closingReport.id == null}" Label="Booking Type"/>
                                <apex:outputField value="{!VacancyRecord.Booking_Type__c}" rendered="{!closingReport.id != null}" Label="Booking Type"/>
                                
                                <apex:inputField value="{!closingReport.TR1__Timesheet_Approver__c}" required="true" rendered="{!closingReport.id == null}" />
                                <apex:outputField value="{!closingReport.TR1__Timesheet_Approver__r.Name}" rendered="{!closingReport.id != null}" />
                                
                                <!--<apex:pageBlockSectionItem >
</apex:pageBlockSectionItem>-->
                                <!--    <apex:outputLabel value="Hiring Manager" />-->
                                <!--    <apex:outputText label="Reports To" />-->
                                
                                <!--<apex:pageBlockSectionItem >-->
                                <!--    <apex:outputlabel value="Booking Type" rendered="{!closingReport.id == null}" />-->
                                <!--    <apex:inputField required="true" rendered="{!closingReport.id == null}" />-->
                                <!--</apex:pageBlockSectionItem>-->
                                <apex:pageBlockSectionItem >
                                    
                                    <apex:outputLabel value="Select Start Date" />
                                    <apex:outputPanel >
                                        <div class="requiredInput">
                                            <div class="requiredBlock"></div>
                                            
                                            <apex:inputText value="{!startDateEnterred}" id="targetDateToUpdate1" /> 
                                        </div>
                                    </apex:outputPanel>
                                </apex:pageBlockSectionItem>
                                
                                
                                <apex:pageBlockSectionItem >
                                    <apex:outputLabel value="School Working Days" />
                                    <apex:outputPanel >
                                        <div class="requiredInput">
                                            <div class="requiredBlock"></div>
                                            <apex:inputText value="{!closingReport.School_Working_Days__c}" id="swdays" />
                                        </div>
                                    </apex:outputPanel>
                                </apex:pageBlockSectionItem>
                                
                                
                                <apex:pageBlockSectionItem >
                                    <apex:outputLabel value="Select End Date" />
                                    <apex:outputPanel >
                                        <div class="requiredInput">
                                            <div class="requiredBlock"></div>
                                            <apex:inputText value="{!endDateEnterred}" id="targetDateToUpdate2" />
                                        </div>
                                    </apex:outputPanel>
                                </apex:pageBlockSectionItem>
                                
                                
                                <apex:pageBlockSectionItem >
                                    <apex:outputLabel value="Annual Leave Entitlement" />
                                    <apex:outputPanel >
                                        <div class="requiredInput">
                                            <div class="requiredBlock"></div>
                                            <apex:inputText value="{!closingReport.Annual_Leave_Entitlement__c}" id="annualleave" />
                                        </div>
                                    </apex:outputPanel>
                                </apex:pageBlockSectionItem>
                                
                                <apex:pageBlockSectionItem >
                                    <apex:outputLabel value="Comparator Full-Time Annual Salary" />
                                    <apex:outputPanel >
                                        <!--<div class="requiredInput">-->
                                        <!--    <div class="requiredBlock"></div>-->
                                        <apex:inputText value="{!closingReport.Comparator_Full_Time_Annual_Salary__c}" id="cftas2" />
                                        <!--</div>-->
                                    </apex:outputPanel>
                                </apex:pageBlockSectionItem>
                                
                                <!--<apex:pageBlockSectionItem rendered="{!closingReport.id == null}">-->
                                <!--    <apex:outputLabel value="Branch" />-->
                                <!--    <apex:inputField value="{!closingReport.Branch__c}" required="true" />-->
                                <!--</apex:pageBlockSectionItem>-->
                                <apex:pageBlockSectionItem rendered="{!closingReport.id != null}">
                                    <apex:outputLabel value="Shift Multiple" />
                                    <apex:outputLabel value="{!closingReport.Shift_Multiple__c}" />
                                </apex:pageBlockSectionItem>
                                
                                <!--                    <apex:pageBlockSectionItem >
<apex:outputLabel value="Select Start Date" />
<apex:inputField value="{!jobForDate.TR1__Estimated_Start_Date__c}" />
</apex:pageBlockSectionItem>
<apex:pageBlockSectionItem >
<apex:outputLabel value="Select End Date" />
<apex:inputField value="{!jobForDate.TR1__Estimated_End_Date__c}" />
</apex:pageBlockSectionItem>
-->
                            </apex:pageBlockSection>
                            
                            <!--<apex:pageBlockSection columns="1">-->
                            <!--    <apex:pageBlockSectionItem >-->
                            <!--        <apex:outputPanel >-->
                            <!--            <table width="100%" style="text-align:center !important">-->
                            <!--                <thead>-->
                            <!--                    <tr>-->
                            <!--                        <td class="tdHeaderStyle">Monday</td>-->
                            <!--                        <td class="tdHeaderStyle">Tuesday</td>-->
                            <!--                        <td class="tdHeaderStyle">Wednesday</td>-->
                            <!--                        <td class="tdHeaderStyle">Thursday</td>-->
                            <!--                        <td class="tdHeaderStyle">Friday</td>-->
                            <!--                        <td class="tdHeaderStyle">Saturday</td>-->
                            <!--                        <td class="tdHeaderStyle">Sunday</td>-->
                            <!--                    </tr>-->
                            <!--                </thead>-->
                            <!--                <tbody>-->
                            <!--                    <tr>-->
                            <!--                        <apex:repeat value="{!shiftTableList}" var="shiftRec">-->
                            <!--                            <td>-->
                            <!--                                <apex:selectList value="{!shiftRec.selectedType}" size="1" multiselect="false" rendered="{!shiftRec.isActive}">-->
                            <!--                                    <apex:selectOptions value="{!shiftRec.optionList}" />-->
                            <!--                                </apex:selectList>-->
                            <!--                            </td>-->
                            <!--                        </apex:repeat>-->
                            <!--                    </tr>-->
                            <!--                </tbody>-->
                            <!--            </table>-->
                            <!--        </apex:outputPanel>-->
                            <!--    </apex:pageBlockSectionItem>-->
                            <!--</apex:pageBlockSection> -->
                            <br/>
                            <apex:pageBlockSection >
                                
                                <apex:inputField value="{!closingReport.TR1__Job_Credit__c}" rendered="{!closingReport.id == null}"  required="True"/> 
                                <!--<apex:outputField value="{!vacancy.OwnerId}" rendered="{!closingReport.id != null}" label="Vacancy Credit" />-->
                                <apex:inputField value="{!closingReport.TR1__Job_Percentage__c}" rendered="{!closingReport.id == null}" required="True"/>
                                <apex:outputField value="{!closingReport.TR1__Job_Percentage__c}" rendered="{!closingReport.id != null}" label="Vacancy Percentage" />
                                
                                <apex:inputField value="{!closingReport.TR1__Candidate_Credit__c}" rendered="{!closingReport.id == null}" />
                                <apex:outputField value="{!closingReport.TR1__Candidate_Credit__r.Name}" rendered="{!closingReport.id != null}" label="Candidate Credit" />
                                <apex:inputField value="{!closingReport.TR1__Candidate_Percentage__c}" rendered="{!closingReport.id == null}" />
                                <apex:outputField value="{!closingReport.TR1__Candidate_Percentage__c}" rendered="{!closingReport.id != null}" label="Candidate Credit" />
                                
                                <apex:inputField value="{!closingReport.TR1__Marketing_Credit__c}" rendered="{!closingReport.id == null}" label="Marketing Credit" />
                                <apex:outputField value="{!closingReport.TR1__Marketing_Credit__r.Name}" rendered="{!closingReport.id != null}" label="Marketing Credit" />
                                <apex:inputField value="{!closingReport.TR1__Marketing_Percentage__c}" rendered="{!closingReport.id == null}" label="Marketing Percentage" />
                                <apex:outputField value="{!closingReport.TR1__Marketing_Percentage__c}" rendered="{!closingReport.id != null}" label="Marketing Percentage" />
                                
                                <apex:inputField value="{!closingReport.TR1__Other_Credit__c}" rendered="{!closingReport.id == null}" label="Other Credit" />
                                <apex:outputField value="{!closingReport.TR1__Other_Credit__r.Name}" rendered="{!closingReport.id != null}" label="Other Credit" />
                                <apex:inputField value="{!closingReport.TR1__Other_Percentage__c}" rendered="{!closingReport.id == null}" label="Other Percentage" />
                                <apex:outputField value="{!closingReport.TR1__Other_Percentage__c}" rendered="{!closingReport.id != null}" label="Other Percentage" />
                                
                                <apex:inputField value="{!closingReport.TR1__Other2_Credit__c}" rendered="{!closingReport.id == null}" label="Other2 Credit" />
                                <apex:outputField value="{!closingReport.TR1__Other2_Credit__r.Name}" rendered="{!closingReport.id != null}" label="Other2 Credit" />
                                <apex:inputField value="{!closingReport.TR1__Other2_Percentage__c}" rendered="{!closingReport.id == null}" label="Other2 Percentage" />
                                <apex:outputField value="{!closingReport.TR1__Other2_Percentage__c}" rendered="{!closingReport.id != null}" label="Other2 Percentage" />
                            </apex:pageBlockSection>
                        </apex:pageBlock>
                    </div>
                    
                </apex:outputPanel>
            </apex:outputPanel>
            
            
            <apex:actionFunction name="createVacancyReord" action="{!openCreateVacancyRecordDialog}" status="searchOverlay" rerender="dialogBoxforVacancy" immediate="true" oncomplete="applyJqueryFunctions();" />
            
            <apex:outputPanel id="dialogBoxforVacancy">
                <apex:actionRegion >
                    <apex:outputPanel rendered="{!showCreateVacancyRecord}">
                        <script>
                        j$('#createVacancyDiv').dialog({
                            title: 'Create Vacancy',
                            resizable: false,
                            modal: true,
                            closeOnEscape: false,
                            width: 1300,
                            position: {
                                my: "center",
                                at: "center"
                            },
                            zIndex: 990,
                            buttons: {
                                "Save": function() {
                                    //event.preventDefault(); 
                                    if (true) {
                                        saveCreateVacancyRecord();
                                        j$(this).dialog("destroy");
                                    }
                                },
                                Cancel: function() {
                                    //cancelEditEvent();
                                    j$(this).dialog("destroy");
                                    cancelVacancyCreation();
                                }
                            },
                        }).parent().appendTo(j$("#pageId\\:formId"));
                        
                        // Destroy all Tooltips
                        j$('.applyTooltipStyle').tooltip("destroy");
                        
                        applyButtonSet();
                        
                        function applyButtonSet() {
                            j$("#selectDaysDiv").buttonset();
                        }
                        </script>
                        
                        <apex:actionFunction name="saveCreateVacancyRecord" action="{!saveCreateVacancyRecord}" status="searchOverlay" rerender="closingReportMsgId,dialogBoxforVacancy,vacMsgId,formId,dialogBox"  oncomplete="validateAmount();applyJqueryFunctions();applyButtonSet();" />
                        <apex:actionFunction name="cancelVacancyCreation" action="{!cancelVacancyCreation}" status="searchOverlay" rerender="closingReportMsgId,dialogBoxforVacancy,vacMsgId,formId,dialogBox" immediate="true" oncomplete="applyJqueryFunctions();applyButtonSet();" />
                        
                        <div id="createVacancyDiv" style="display:none">
                            <apex:pageBlock id="dialogBoxPageBlockId" mode="edit" >
                                
                                <apex:pageMessages id="vacMsgId" />
                                
                                <apex:pageBlockSection columns="2" collapsible="false" >
                                    
                                    <apex:pageBlockSectionItem >
                                        
                                        <apex:outputLabel value="Client Name" for="client__name"/>
                                        <apex:outputPanel styleClass="requiredInput" layout="block" >
                                            <apex:outputPanel styleClass="requiredBlock" layout="block"/>
                                            <apex:actionRegion >
                                                <apex:inputField value="{!vacRecord.TR1__Account__c}" id="client__name" tabOrderHint="1" onchange="schoolNamePopulate()" />
                                                
                                                <apex:actionFunction action="{!doSchoolNamePopulate}" name="schoolNamePopulate" status="loadSubmitStatus" reRender="dialogBoxPageBlockId" oncomplete="applyJqueryFunctions();" />
                                                <apex:actionstatus id="loadSubmitStatus" dir="RTL"> 
                                                    <apex:facet name="start"> 
                                                        <apex:image url="/img/loading.gif" alt=" Processing.... "></apex:image>
                                                    </apex:facet>
                                                </apex:actionstatus>
                                            </apex:actionRegion>
                                        </apex:outputPanel>
                                    </apex:pageBlockSectionItem>
                                    
                                    <apex:pageBlockSectionItem >
                                        <apex:outputLabel value="Pay Type" for="pay__type"/>
                                        <apex:outputPanel styleClass="requiredInput" layout="block" >
                                            <apex:outputPanel styleClass="requiredBlock" layout="block"/>
                                            <apex:inputField value="{!vacRecord.Shift__c}"  id="pay__type" tabOrderHint="12">
                                                <apex:actionSupport event="onchange" rerender="dialogBoxPageBlockId,thePageBlock2,thePageBlock2_label,thePageBlock3,thePageBlock4,vacMsgId" oncomplete="applyJqueryFunctions();" status="searchOverlay" action="{!doSchoolNamePopulate}"/> 
                                            </apex:inputField>
                                        </apex:outputPanel>
                                    </apex:pageBlockSectionItem>
                                    
                                    <apex:pageBlockSectionItem >
                                        <apex:outputLabel value="School Type" for="school__type"/>
                                        <apex:outputPanel styleClass="requiredInput" layout="block" >
                                            <apex:outputPanel styleClass="requiredBlock" layout="block"/>
                                            <apex:inputField value="{!vacRecord.School_Type__c}" id="school__type" tabOrderHint="2"/>
                                        </apex:outputPanel>
                                    </apex:pageBlockSectionItem>
                                    
                                    <!--  <apex:pageBlockSectionItem >
<apex:outputPanel id="thePageBlock_label">
<apex:outputLabel value="Hour Pay Rate" for="maxHRchr" rendered="{!vacRecord.Shift__c=='Hourly'}"/>
<apex:outputLabel value="Day Pay Rate" for="maxDchr" rendered="{!vacRecord.Shift__c=='Daily'}" />
<apex:outputLabel value="AM/PM Pay Rate" for="maxHLFch" rendered="{!OR(vacRecord.Shift__c=='AM',vacRecord.Shift__c=='PM')}"/>
</apex:outputPanel>
<apex:outputPanel id="thePageBlock">
<apex:inputField value="{!vacRecord.Maximum_Hour_Pay_Rate__c}"  rendered="{!vacRecord.Shift__c=='Hourly'}" label="Pay Rate" id="maxHRchr"  tabOrderHint="13"/>
<apex:inputField value="{!vacRecord.TR1__Maximum_Pay_Rate__c}"  rendered="{!vacRecord.Shift__c=='Daily'}" label="Pay Rate" id="maxDch"  tabOrderHint="13" />
<apex:inputField value="{!vacRecord.TR1__Minimum_Pay_Rate__c}"  rendered="{!OR(vacRecord.Shift__c=='AM',vacRecord.Shift__c=='PM')}" label="Pay Rate" id="maxHLFch" tabOrderHint="13" />
</apex:outputPanel>
</apex:pageBlockSectionItem> -->
                                    <apex:pageBlockSectionItem >
                                        <apex:outputPanel id="thePageBlock2_label" >
                                            <apex:outputLabel value="Hour Charge Rate" for="maxHRPay" rendered="{!vacRecord.Shift__c=='Hourly'}"/>
                                            <apex:outputLabel value="Day Charge Rate" for="maxDPay" rendered="{!vacRecord.Shift__c=='Daily'}"/>
                                            <apex:outputLabel value="AM/PM Charge Rate" for="maxHLFPay" rendered="{!OR(vacRecord.Shift__c=='AM',vacRecord.Shift__c=='PM')}"/>
                                        </apex:outputPanel>
                                        <apex:outputPanel id="thePageBlock2" >
                                            <apex:inputField value="{!vacRecord.Maximum_Hour_Charge_Rate__c}"  rendered="{!vacRecord.Shift__c=='Hourly'}" id="maxHRPay"  tabOrderHint="14"/>
                                            <apex:inputField value="{!vacRecord.TR1__Maximum_Bill_Rate__c}"  rendered="{!vacRecord.Shift__c=='Daily'}" id="maxDPay" tabOrderHint="14"/>
                                            <apex:inputField value="{!vacRecord.TR1__Minimum_Bill_Rate__c}"  rendered="{!OR(vacRecord.Shift__c=='AM',vacRecord.Shift__c=='PM')}" id="maxHLFPay"  tabOrderHint="14"/>
                                        </apex:outputPanel>
                                    </apex:pageBlockSectionItem>
                                    
                                    <apex:pageBlockSectionItem >
                                        <apex:outputLabel value="Contact" for="contact__id"/>
                                        <apex:outputPanel styleClass="requiredInput" layout="block" >
                                            <apex:outputPanel styleClass="requiredBlock" layout="block"/>
                                            <apex:inputField value="{!vacRecord.TR1__Contact__c}" id="contact__id" tabOrderHint="3"/>
                                        </apex:outputPanel>
                                    </apex:pageBlockSectionItem>
                                    
                                    <apex:pageBlockSectionItem >
                                        <apex:outputLabel value="Hiring Manager" for="hiring__manager"/>
                                        <apex:outputPanel styleClass="requiredInput" layout="block" >
                                            <apex:outputPanel styleClass="requiredBlock" layout="block"/>
                                            <apex:inputField value="{!vacRecord.TR1__Hiring_Manager__c}" id="hiring__manager" tabOrderHint="4"/>
                                        </apex:outputPanel>
                                    </apex:pageBlockSectionItem>
                                    
                                    <apex:pageBlockSectionItem >
                                        <apex:outputLabel value="Estimated Start Date" for="estimated__start__date"/>
                                        <apex:outputPanel styleClass="requiredInput" layout="block" >
                                            <apex:outputPanel styleClass="requiredBlock" layout="block"/>
                                            <apex:inputField value="{!vacRecord.TR1__Estimated_Start_Date__c}" id="estimated__start__date" tabOrderHint="15"/>
                                        </apex:outputPanel>
                                    </apex:pageBlockSectionItem>
                                    
                                    <apex:pageBlockSectionItem >
                                        <apex:outputLabel value="Timesheet Approver" for="Timesheet Approver"/>
                                        <apex:outputPanel styleClass="requiredInput" layout="block" >
                                            <apex:outputPanel styleClass="requiredBlock" layout="block"/>
                                            <apex:inputField value="{!vacRecord.Timesheet_Approver__c}" id="Timesheet__Approver" tabOrderHint="4" />
                                        </apex:outputPanel>
                                    </apex:pageBlockSectionItem>
                                    
                                    <apex:pageBlockSectionItem >
                                        <apex:outputLabel value="Booking Type" for="booking__type"/>
                                        <apex:outputPanel styleClass="requiredInput" layout="block" >
                                            <apex:outputPanel styleClass="requiredBlock" layout="block"/>
                                            <apex:inputField value="{!vacRecord.Booking_Type__c}" id="booking__type" tabOrderHint="5"/>
                                        </apex:outputPanel>
                                    </apex:pageBlockSectionItem>
                                    
                                    <apex:pageBlockSectionItem >
                                        <apex:outputLabel value="Estimated End Date" for="estimated__end__date"/>
                                        <apex:outputPanel styleClass="requiredInput" layout="block" >
                                            <apex:outputPanel styleClass="requiredBlock" layout="block"/>
                                            <apex:inputField value="{!vacRecord.TR1__Estimated_End_Date__c}" id="estimated__end__date" tabOrderHint="16"/>
                                        </apex:outputPanel>
                                    </apex:pageBlockSectionItem>
                                    
                                    <apex:pageBlockSectionItem >
                                        <apex:outputLabel value="Booking Reason" for="booking__rsn"/>
                                        <apex:outputPanel styleClass="requiredInput" layout="block" >
                                            <apex:outputPanel styleClass="requiredBlock" layout="block"/>
                                            <apex:inputField value="{!vacRecord.Booking_Reason__c}" id="booking__rsn" tabOrderHint="6"/>
                                        </apex:outputPanel>
                                    </apex:pageBlockSectionItem>
                                    
                                    
                                    
                                    <apex:pageBlockSectionItem >
                                        <apex:outputLabel value="Start Time" for="start__time"/>
                                        <apex:outputPanel styleClass="requiredInput" layout="block" id="thePageBlock3" >
                                            <apex:outputPanel styleClass="requiredBlock" layout="block"/>
                                            <apex:inputField value="{!vacRecord.Start_Time__c}" id="start__time" tabOrderHint="17"/>
                                        </apex:outputPanel>
                                    </apex:pageBlockSectionItem>
                                    <apex:pageBlockSectionItem >
                                        <apex:outputLabel value="Vacancy Name" for="vacancy__name"/>
                                        <apex:outputPanel styleClass="requiredInput" layout="block" >
                                            <apex:outputPanel styleClass="requiredBlock" layout="block"/>
                                            <apex:inputField value="{!vacRecord.Name}" id="vacancy__name" tabOrderHint="7"/>
                                        </apex:outputPanel>
                                    </apex:pageBlockSectionItem>
                                    
                                    <apex:pageBlockSectionItem >
                                        <apex:outputLabel value="End Time" for="end__time"/>
                                        <apex:outputPanel styleClass="requiredInput" layout="block" id="thePageBlock4">
                                            <apex:outputPanel styleClass="requiredBlock" layout="block"/> 
                                            <apex:inputField value="{!vacRecord.End_Time__c}" id="end__time" tabOrderHint="18"/>
                                        </apex:outputPanel>
                                    </apex:pageBlockSectionItem>
                                    
                                    <apex:pageBlockSectionItem >
                                        <apex:outputLabel value="Job Title" for="job__title"/>
                                        <apex:outputPanel styleClass="requiredInput" layout="block" >
                                            <apex:outputPanel styleClass="requiredBlock" layout="block"/>
                                            <apex:inputField value="{!vacRecord.Job_Title__c}" id="job__title" tabOrderHint="7"/>
                                        </apex:outputPanel>
                                    </apex:pageBlockSectionItem>
                                    
                                    
                                    
                                    <!-- apex:pageBlockSectionItem >
</apex:pageBlockSectionItem> -->
                                    
                                    <apex:pageBlockSectionItem >
                                        <apex:outputLabel value="Overnight Shift?" />
                                        <apex:inputCheckbox id="ngtShifting" value="{!isMidNight}" tabIndex="0"/>
                                    </apex:pageBlockSectionItem>
                                    
                                    <apex:pageBlockSectionItem >
                                        <apex:outputLabel value="Subject" for="subject__name"/>
                                        <apex:inputField value="{!vacRecord.Subject2__c}" id="subject__name" tabOrderHint="9"/>
                                    </apex:pageBlockSectionItem>
                                    
                                    <apex:pageBlockSectionItem >
                                        <apex:outputLabel value="Applicable Days" for="applicable__days"/>
                                        <apex:outputPanel styleClass="requiredInput" layout="block" >
                                            <apex:outputPanel styleClass="requiredBlock" layout="block"/>
                                            <apex:inputField value="{!vacRecord.Applicable_Days__c}" id="applicable__days" tabOrderHint="20"/>
                                        </apex:outputPanel>
                                    </apex:pageBlockSectionItem>
                                    
                                    <apex:pageBlockSectionItem >
                                        <apex:outputLabel value="Year/Key Stage" for="year__key__stage"/>
                                        <apex:inputField value="{!vacRecord.Year_Key_Stage__c}" id="year__key__stage" tabOrderHint="10"/>
                                    </apex:pageBlockSectionItem>
                                    
                                    <!-- <apex:pageBlockSectionItem >
<apex:outputLabel value="Trained As" for="trained__as"/>
<apex:outputPanel styleClass="requiredInput" layout="block" >
<apex:outputPanel styleClass="requiredBlock" layout="block"/>
<apex:inputField value="{!vacRecord.Trained_As__c}" id="trained__as" tabOrderHint="21"/>
</apex:outputPanel>
</apex:pageBlockSectionItem>-->
                                    
                                    <apex:pageBlockSectionItem >
                                        <apex:outputLabel value="Notes" for="notes__text__area"/>
                                        <apex:inputField value="{!vacRecord.Notes__c}" id="notes__text__area" tabOrderHint="11"/>
                                    </apex:pageBlockSectionItem>
                                    
                                    <apex:pageBlockSectionItem >
                                        <apex:outputLabel value="SEN Experience" for="sen__experience"/>
                                        <apex:inputField value="{!vacRecord.SEN_Experience__c}" id="sen__experience" tabOrderHint="22"/>
                                    </apex:pageBlockSectionItem>
                                    
                                    <apex:pageBlockSectionItem >
                                        <apex:outputLabel value="Chatter Team" for="chatter__team"/>
                                        <apex:inputField value="{!vacRecord.Chatter_Team__c}" id="chatter__team" tabOrderHint="12"/>
                                    </apex:pageBlockSectionItem>
                                    
                                    <!--  <apex:pageBlockSectionItem >
<apex:outputLabel value="SEN Skills, Quals and Training" for="sen__skills__quals__and__training"/>
<apex:inputField value="{!vacRecord.SEN_Additional_Experience__c}" id="sen__skills__quals__and__training" tabOrderHint="23"/>
</apex:pageBlockSectionItem> -->
                                    
                                    <apex:pageBlockSectionItem >
                                        <apex:outputLabel value="Vacancy Owner" for="Vacancy_Owner"/>
                                        <apex:inputField value="{!vacRecord.ownerId}" id="userId" />
                                    </apex:pageBlockSectionItem>
                                    
                                    <apex:pageBlockSectionItem >
                                        <apex:outputLabel value="Skills Training Experience" for="skills__training__experience"/>
                                        <apex:inputField value="{!vacRecord.Skills_Training_Experience__c}" id="skills__training__experience" tabOrderHint="24"/>
                                    </apex:pageBlockSectionItem>
                                    
                                    
                                </apex:pageBlockSection>
                                <br/><br/>
                            </apex:pageBlock>
                        </div>
                    </apex:outputPanel>
                </apex:actionRegion>
            </apex:outputPanel>
            <apex:actionFunction name="cloneVacancyReord" action="{!openCloneVacancyrecordDialog}" status="searchOverlay" rerender="dialogBoxforVacancy" immediate="true" oncomplete="applyJqueryFunctions();"/>
        </apex:form>
    </div>
</apex:page>